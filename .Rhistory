ggtitle("Spawners")
ggsave("output/Plot_Mean_Scale_Spawners_Chum.jpg",height = 4, width = 7)
library(readxl)
df <- read_xl("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx")
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx")
View(df)
View(df)
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1)
View(df)
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
mutate(Year = as.numeric(Year),
Mean = as.numeric(Mean))
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
mutate(Year = as.numeric(Year),
Mean = as.numeric(Mean),
SD = as.numeric(SD)) %>%
select(1:4)
unique(df$`Reporting Group`)
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
rename(reporting_group = `Reporting Group`)
View(df)
df <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
rename(reporting_group = `Reporting Group`) %>%
mutate(Year = as.numeric(Year),
Mean = as.numeric(Mean),
SD = as.numeric(SD)) %>%
dplyr::select(1:4) %>%
filter(reporting_group %in% c("Coastal Western Alaska","Yukon River Fall Run"))
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
color = reporting_group), stat = "identity")
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
color = reporting_group), stat = "identity", position = "dodge")
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group), stat = "identity", position = "dodge")
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group), stat = "identity", position = "dodge") +
geom_errorbar(aes(x=Year, ymin = Mean-SD, ymax = Mean+SD))
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group), stat = "identity", position = "dodge") +
geom_errorbar(aes(x=Year, ymin = Mean-SD, ymax = Mean+SD,
group = reporting_group,
fill = reporting_group))
# Source for ADFG full time series, Liz Lee emailed on 4-4-2024
adfg <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
rename(reporting_group = `Reporting Group`) %>%
mutate(Year = as.numeric(Year),
Mean = as.numeric(Mean),
SD = as.numeric(SD)) %>%
dplyr::select(1:4) %>%
filter(reporting_group %in% c("Coastal Western Alaska","Yukon River Fall Run"))
ggplot(data =df) +
geom_bar(aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group), stat = "identity", position = "dodge") +
geom_errorbar(aes(x=Year, ymin = Mean-SD, ymax = Mean+SD,
group = reporting_group,
fill = reporting_group)) +
theme_classic()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD). width = 0.1) +
theme_classic()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()  +
facet_wrap(~reporting_group)
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "stack") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "stack") +
#geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()  +
facet_wrap(~reporting_group)+
viridis::scale_fill_viridis_d()
library(viridis)
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()  +
facet_wrap(~reporting_group)+
scale_fill_viridis_d()
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()  +
facet_wrap(~reporting_group)+
scale_fill_viridis_d()+
theme(legend.position = "top")
ggplot(data =df,aes(x=Year, y = Mean, group = reporting_group,
fill = reporting_group)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD), width = 0.1) +
theme_classic()  +
facet_wrap(~reporting_group)+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
# Compare ADFG FALL WITH Kondeleza FALL ===================
fall_kondeleza <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year")
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza)
View(yukon_comp)
# Compare ADFG FALL WITH Kondeleza FALL ===================
fall_kondeleza <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year",
kondeleza_mean = "percent_mean")
unique(adfg$reporting_group)
# Source for ADFG full time series, Liz Lee emailed on 4-4-2024
adfg <- read_excel("data/BeringSea_Chum_Juv_annual_2003-2023_analysis_msa.xlsx") %>%
janitor::row_to_names(row_number = 1) %>%
rename(reporting_group = `Reporting Group`) %>%
mutate(Year = as.numeric(Year),
Mean = as.numeric(Mean),
SD = as.numeric(SD),
reporting_group = case_when(reporting_group == "Yukon River Fall Run"~ "Yukon_Fall",
reporting_group == "Coastal Western Alaska"~ "CWAK",
TRUE ~ reporting_group )) %>%
dplyr::select(1:4) %>%
filter(reporting_group %in% c("CWAK","Yukon_Fall"))
# Compare ADFG FALL WITH Kondeleza FALL ===================
fall_kondeleza <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year",
kondeleza_mean = "percent_mean")
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza)
View(yukon_comp)
# Compare ADFG FALL WITH Kondeleza FALL ===================
fall_kondeleza <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year",
kondeleza_mean = "percent_mean") %>%
rename(reporting_group_actual = "reporting_group") %>%
mutate(reporting_group=case_when(reporting_group_actual == "Yukon_Summer"~ "CWAK",
TRUE ~ reporting_group_actual))
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza)
View(yukon_comp)
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
select(1:3,6)
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
dplyr::select(1:3,6) %>%
gather(3:4, key = "key", value = "value")
ggplot(data =yukon_comp, aes(x=Year, y=adfg_mean, group = "key", fill = "key")) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
facet_wrap(~reporting_group)
ggplot(data =yukon_comp, aes(x=Year, y=value, group = "key", fill = "key")) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
facet_wrap(~reporting_group)
ggplot(data =yukon_comp, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
facet_wrap(~reporting_group)
ggplot(data =yukon_comp, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge" ) +
facet_wrap(~reporting_group)
ggplot(data =yukon_comp, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge" ) +
facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
# compare fall to fall
yukon_comp <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
dplyr::select(1:3,6) %>%
filter(reporting_group == "Yukon_Fall") %>%
gather(3:4, key = "key", value = "value")
View(yukon_comp)
ggplot(data =yukon_comp_fall, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
# compare fall to fall
yukon_comp_fall <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
dplyr::select(1:3,6) %>%
filter(reporting_group == "Yukon_Fall") %>%
gather(3:4, key = "key", value = "value")
ggplot(data =yukon_comp_fall, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
ggplot(data =yukon_comp_fall, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
ggplot(data =yukon_comp_fall, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion")
ggsave("output/Plot_compare_adfg_kondeleza_fall.jpg")
yukon_comp_cwak_summer <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza)
View(yukon_comp_cwak_summer)
# compare summer to CWAK ============
yukon_comp_cwak_summer <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
dplyr::select(1:3,6) %>%
filter(!reporting_group == "Yukon_Fall") %>%
gather(3:4, key = "key", value = "value")
ggplot(data =yukon_comp_fall, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggplot(data =yukon_comp_cwak_summer, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
# compare summer to CWAK ============
yukon_comp_cwak_summer <- adfg %>%
dplyr::rename(adfg_mean = "Mean") %>%
left_join(fall_kondeleza) %>%
dplyr::select(1:3,6) %>%
filter(!reporting_group == "Yukon_Fall") %>%
gather(3:4, key = "key", value = "value") %>%
mutate(key = case_when(key == "adfg_mean" ~ "CWAK (ADFG)",
key == "kondeleza_mean" ~ "Summer Yukon (Kondeleza)",
))
ggplot(data =yukon_comp_cwak_summer, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value)
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value) %>%
dplyr::mutate(ratio = `Summer Yukon (Kondeleza)`/`CWAK (ADFG)`)
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("Summer:CWAK Ratio)
ggsave("output/Plot_summer_CWAK_ratio.jpg")
# mean proportions ==================
# to use for now
mean_prop <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year")
group_by(reporting_group) %>%
dplyr::summarise(mean = mean(percent_mean))
write_csv(mean_prop, "data/mean_prop_basis.csv")
# prop_cwak <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
#   dplyr::rename(Year = "year") %>%
#   dplyr::mutate(larger_group =case_when(reporting_group %in% c("Yukon_Summer", "Kusko_Bristol") ~ "CWAK",
#                                         TRUE ~ reporting_group)) %>%
#   filter(larger_group %in% c("CWAK")) %>%
#   group_by(Year) %>%
#   dplyr::mutate(cwak_sum = sum(percent_mean),
#          percent_summer = percent_mean/cwak_sum,
#          percent_cwak_other=1-percent_summer) %>%
#   filter(!reporting_group == "Kusko_Bristol") %>%
#   dplyr::select(Year, percent_summer, percent_cwak_other) %>%
#   gather(2:3, key = "key", value = "prop")
#
# ggplot(prop_cwak, aes( x=Year,y=prop,fill=key,group=key)) +
#   geom_bar(position="stack", stat="identity")
#
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("Summer:CWAK Ratio")
View(yukon_ratio_cwak_summer)
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value) %>%
dplyr::mutate(ratio = `Summer Yukon (Kondeleza)`/(`Summer Yukon (Kondeleza)`+`CWAK (ADFG)`))
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("Summer:CWAK Ratio")
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("Summer Percent of CWAK")
ggsave("output/Plot_summer_CWAK_Percent.jpg")
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Percent") +
ggtitle("Summer Percent of CWAK")
ggplot(data =yukon_comp_cwak_summer, aes(x=Year, y=value, group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggsave("output/Plot_compare_CWAK_Summer.jpg")
expand_adfg_summer_fall <- adfg %>%
dplyr::select(-SD) %>%
spread(reporting_group, Mean)
View(expand_adfg_summer_fall)
expand_adfg_summer_fall <- adfg %>%
dplyr::select(-SD) %>%
spread(reporting_group, Mean) %>%
dplyr::mutate(Yukon_Smmer= 0.4*CWAK)
View(expand_adfg_summer_fall)
expand_adfg_summer_fall <- adfg %>%
dplyr::select(-SD) %>%
spread(reporting_group, Mean) %>%
dplyr::mutate(Yukon_Smmer= 0.4*CWAK) %>%
gather(2:4, key = "key", value = "value")
ggplot(data =expand_adfg_summer_fall, aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top")
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value) %>%
dplyr::mutate(ratio = `Summer Yukon (Kondeleza)`/(CWAK (ADFG)`))
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Percent") +
ggtitle("Summer Percent of CWAK")
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value) %>%
dplyr::mutate(ratio = `Summer Yukon (Kondeleza)`/(`CWAK (ADFG)`))
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Percent") +
ggtitle("Summer Percent of CWAK")
yukon_ratio_cwak_summer <- yukon_comp_cwak_summer%>%
spread(key, value) %>%
dplyr::mutate(ratio = `Summer Yukon (Kondeleza)`/`CWAK (ADFG)`)
ggplot(data =yukon_ratio_cwak_summer, aes(x=Year, y=ratio)) +
geom_bar(stat = "identity", color = "black" ) +
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Percent") +
ggtitle("Summer Percent of CWAK")
View(yukon_ratio_cwak_summer)
ggsave("output/Plot_summer_CWAK_Percent.jpg")
expand_adfg_summer_fall <- adfg %>%
dplyr::select(-SD) %>%
spread(reporting_group, Mean) %>%
dplyr::mutate(Yukon_Smmer= 0.77*CWAK) %>%
gather(2:4, key = "key", value = "value")
ggplot(data =expand_adfg_summer_fall, aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggplot(data =expand_adfg_summer_fall %>%
filter(!key == "CWAK"), aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggplot(data =expand_adfg_summer_fall, aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggsave("output/Plot_summer_CWAK_summer_fall.jpg")
ggplot(data =expand_adfg_summer_fall, aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggsave("output/Plot_estimated_CWAK_summer_fall.jpg")
ggplot(data =expand_adfg_summer_fall %>%
filter(!key == "CWAK"), aes(x=Year, y=value,
group =key, fill = key)) +
geom_bar(stat = "identity", position = "dodge", color = "black" ) +
#facet_wrap(~reporting_group)+
theme_classic()+
scale_fill_viridis_d()+
theme(legend.position = "top") +
ylab("Mean Proportion") +
ggtitle("CWAK and Yukon Summer")
ggsave("output/Plot_estimated_summer_fall.jpg")
#Kondeleza Yukon ===================
prop_yukon <- read_xlsx("data/BASIS_reporting_groups_comp.xlsx") %>%
filter(reporting_group %in% c("Yukon_Fall", "Yukon_Summer")) %>%
dplyr::rename(Year = "year")
ggplot(prop_yukon, aes( x=reporting_group,y=percent_mean,fill=Year,group=Year)) +
geom_bar(position="dodge", stat="identity")
proportions <- ggplot(prop_yukon, aes(x=Year,y=percent_mean,fill=reporting_group,group=reporting_group)) +
geom_bar(position="stack",
stat="identity", color = "black")  +
xlab("Year") +
ylab("Percent of Total BASIS haul")+
theme_classic() +
viridis::scale_fill_viridis_d()
proportions <- ggplot(prop_yukon, aes(x=Year,y=percent_mean,fill=reporting_group,group=reporting_group)) +
geom_bar(position="stack",
stat="identity", color = "black")  +
xlab("Year") +
ylab("Percent of Total BASIS haul")+
theme_classic() +
scale_fill_viridis_d()
proportions
proportions <- ggplot(prop_yukon, aes(x=Year,y=percent_mean,fill=reporting_group,group=reporting_group)) +
geom_bar(position="dodge",
stat="identity", color = "black")  +
xlab("Year") +
ylab("Percent of Total BASIS haul")+
theme_classic() +
scale_fill_viridis_d()
proportions
ggsave("output/Plot_BASIS_proportions_2003_2007.jpg")
