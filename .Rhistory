bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
# init = list(
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   )
#),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
# init = list(
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   ),
#   list(
#     log_N_j = runif(1,5,15),
#     log_N_sp = runif(1,8,15)
#   )
#),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = list(
list(
log_N_j = runif(1,5,15),
log_N_sp = runif(1,8,15)
),
list(
log_N_j = runif(1,5,15),
log_N_sp = runif(1,8,15)
),
list(
log_N_j = runif(1,5,15),
log_N_sp = runif(1,8,15)
),
list(
log_N_j = runif(1,5,15),
log_N_sp = runif(1,8,15)
)
),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
sim_yukon_spring_df$N_sp
sim_yukon_fall_df$N_sp
data_stage_sp
data_stage_j
g
N
N_stock
K
runif(1,5,15)
exp(11.1)
min(data_stage_sp)
max(data_stage_sp)
exp(10)
exp(15)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = list(
list(
log_N_j = runif(1,2,12),
log_N_sp = runif(1,2,12)
),
list(
log_N_j = runif(1,2,12),
log_N_sp = runif(1,2,12)
),
list(
log_N_j = runif(1,2,12),
log_N_sp = runif(1,2,12)
),
list(
log_N_j = runif(1,2,12),
log_N_sp = runif(1,2,12)
)
),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
# init = list(
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   )
# ),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
# init = list(
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   ),
#   list(
#     log_N_j = runif(1,2,12),
#     log_N_sp = runif(1,2,12)
#   )
# ),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
runif(300,2,12)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = list(
list(
log_N_j = runif(300,2,12),
log_N_sp = runif(300,2,12)
),
list(
log_N_j = runif(300,2,12),
log_N_sp = runif(300,2,12)
),
list(
log_N_j = runif(300,2,12),
log_N_sp = runif(300,2,12)
),
list(
log_N_j = runif(300,2,12),
log_N_sp = runif(300,2,12)
)
),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
exp(10)
exp(rnorm(10,0.001))
hist(exp(rnorm(10000, 10,0.001)))
hist(exp(rnorm(10000, 12,0.001)))
hist(exp(rnorm(10000, 15,0.001)))
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
# init = list(
#   list(
#     log_N_j = runif(300,2,12),
#     log_N_sp = runif(300,2,12)
#   ),
#   list(
#     log_N_j = runif(300,2,12),
#     log_N_sp = runif(300,2,12)
#   ),
#   list(
#     log_N_j = runif(300,2,12),
#     log_N_sp = runif(300,2,12)
#   ),
#   list(
#     log_N_j = runif(300,2,12),
#     log_N_sp = runif(300,2,12)
#   )
# ),
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
normal(15,0.001)
rnorm(15,0.001)
dnorm(15,0.001)
init_list <- list(
list(p_1= 0.05 ,
p_2 =0.10,
c_1 = 1500000,
c_2 = 1800000000,
log_N_sp_start= 12.5,
sigma_y_j = 0.02,
sigma_y_sp = 0.03),
list(
p_1= 0.04 ,
p_2 =0.11,
c_1 = 1600000,
c_2 = 1700000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.041 ,
p_2 =0.13,
c_1 = 1700000,
c_2 = 1900000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.022,
p_2 =0.14,
c_1 = 1800000,
c_2 = 1600000000,
log_N_sp_start= 13,
sigma_y_j = 0.014,
sigma_y_sp = 0.033))
# Organize data call inputs ================================================
K = 1 # number of stocks involved
N_stock <- c(nrow(sim_yukon_spring_df))
#N_stock <- c(nrow(sim_yukon_spring_df), nrow(sim_yukon_fall_df), nrow(sim_kusko_df))
N = sum(N_stock)
g = c(rep(1, times = N_stock[1]))#, # Vector of group assignments.
# Organize data call inputs ================================================
K = 1 # number of stocks involved
N_stock <- c(nrow(sim_yukon_spring_df))
#N_stock <- c(nrow(sim_yukon_spring_df), nrow(sim_yukon_fall_df), nrow(sim_kusko_df))
N = sum(N_stock)
g = c(rep(1, times = N_stock[1]))#, # Vector of group assignments.
data_stage_j <- c(as.integer(sim_yukon_spring_df$N_j))#,
data_stage_sp <- c(as.integer(sim_yukon_spring_df$N_sp))#,
data_list <- list(Ps = Ps,
fs=fs,
# n_init_years=n_init_years,
N = N,
K = K,
g = g,
N_stock = N_stock,
data_stage_j = data_stage_j,
data_stage_sp = data_stage_sp)
init_list <- list(
list(p_1= 0.05 ,
p_2 =0.10,
c_1 = 1500000,
c_2 = 1800000000,
log_N_sp_start= 12.5,
sigma_y_j = 0.02,
sigma_y_sp = 0.03),
list(
p_1= 0.04 ,
p_2 =0.11,
c_1 = 1600000,
c_2 = 1700000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.041 ,
p_2 =0.13,
c_1 = 1700000,
c_2 = 1900000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.022,
p_2 =0.14,
c_1 = 1800000,
c_2 = 1600000000,
log_N_sp_start= 13,
sigma_y_j = 0.014,
sigma_y_sp = 0.033))
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = init_list,
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
library(rstan)
library(tidyverse)
library(here)
# load simulated data =======================================================
# to start, use simulated data from "scripts/simulate_data.R"
sim_yukon_spring_df <- read_csv("data/Simulated_Yukon_Spring.csv")
sim_yukon_fall_df <- read_csv("data/Simulated_Yukon_Fall.csv")
sim_kusko_df <- read_csv("data/Simulated_Kusko.csv")
# load Covariates  ==========================================================
#covar_temp <- data.frame(temp = c(readRDS("output/covar_temp_sim.RDS")))
#covar_1 <- rep(covar_temp$temp, times = 3)
# setup inputs ==============================================================
warmups <- 1000
total_iterations <- 4000
max_treedepth <-  15
n_chains <-  4
n_cores <- 4
adapt_delta <- 0.95
Ps <- 0.5 # proportion of females - assumption, need to lit check
fs <- 500 # fecundity - random assumption that worked in simulation, need to lit check
# Organize data call inputs ================================================
K = 1 # number of stocks involved
N_stock <- c(nrow(sim_yukon_spring_df))
#N_stock <- c(nrow(sim_yukon_spring_df), nrow(sim_yukon_fall_df), nrow(sim_kusko_df))
N = sum(N_stock)
g = c(rep(1, times = N_stock[1]))#, # Vector of group assignments.
data_stage_j <- c(as.integer(sim_yukon_spring_df$N_j))#,
data_stage_sp <- c(as.integer(sim_yukon_spring_df$N_sp))#,
data_list <- list(Ps = Ps,
fs=fs,
# n_init_years=n_init_years,
N = N,
K = K,
g = g,
N_stock = N_stock,
data_stage_j = data_stage_j,
data_stage_sp = data_stage_sp)
init_list <- list(
list(p_1= 0.05 ,
p_2 =0.10,
c_1 = 1500000,
c_2 = 1800000000,
log_N_sp_start= 12.5,
sigma_y_j = 0.02,
sigma_y_sp = 0.03),
list(
p_1= 0.04 ,
p_2 =0.11,
c_1 = 1600000,
c_2 = 1700000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.041 ,
p_2 =0.13,
c_1 = 1700000,
c_2 = 1900000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.022,
p_2 =0.14,
c_1 = 1800000,
c_2 = 1600000000,
log_N_sp_start= 13,
sigma_y_j = 0.014,
sigma_y_sp = 0.033))
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = init_list,
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = init_list,
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
data_list <- list(Ps = Ps,
fs=fs,
# n_init_years=n_init_years,
N = N,
K = K,
g = g,
#N_stock = N_stock,
data_stage_j = data_stage_j,
data_stage_sp = data_stage_sp)
init_list <- list(
list(p_1= 0.05 ,
p_2 =0.10,
c_1 = 1500000,
c_2 = 1800000000,
log_N_sp_start= 12.5,
sigma_y_j = 0.02,
sigma_y_sp = 0.03),
list(
p_1= 0.04 ,
p_2 =0.11,
c_1 = 1600000,
c_2 = 1700000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.041 ,
p_2 =0.13,
c_1 = 1700000,
c_2 = 1900000000,
log_N_sp_start= 13,
sigma_y_j = 0.015,
sigma_y_sp = 0.034),
list(
p_1= 0.022,
p_2 =0.14,
c_1 = 1800000,
c_2 = 1600000000,
log_N_sp_start= 13,
sigma_y_j = 0.014,
sigma_y_sp = 0.033))
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = init_list,
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
bh_fit <- stan(
file = here::here("scripts", "stan_mod_BH_V1.stan"),
data = data_list,
chains = n_chains,
warmup = warmups,
iter = total_iterations,
cores = n_cores,
refresh = 250,
init = init_list,
control = list(max_treedepth = max_treedepth,
adapt_delta = adapt_delta)
)
