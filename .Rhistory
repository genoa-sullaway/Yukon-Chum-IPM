age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6))
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6))
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6))
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
select(-cal_year) %>%
spread(brood_year, age)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
select(-cal_year) %>%
spread(age,brood_year)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
select(-cal_year) %>%
spread(age,abundance)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
age = as.numeric(age),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6))
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
select(-cal_year) %>%
spread(age,abundance)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year) %>%
group_by(brood_year) %>%
dplyr::mutate(sum = sum(abundance),
percent = abundance/sum)
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year) %>%
group_by(brood_year) %>%
dplyr::mutate(sum = sum(abundance),
percent = abundance/sum) %>%
spread(age,percent)
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year) %>%
group_by(brood_year) %>%
dplyr::mutate(sum = sum(abundance),
percent = abundance/sum) %>%
dplyr::select(-abundance) %>%
spread(age,percent)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year) %>%
group_by(brood_year) %>%
dplyr::mutate(sum = sum(abundance),
percent = abundance/sum) %>%
dplyr::select(-abundance,-sum) %>%
spread(age,percent)
write_csv(yukon_summer,"data/age_comps/processed_age_comps_summer_yukon.csv")
library(tidyverse)
library(here)
# goal get age comps for brood year in %'s - it is provided via calendar year
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,11:14) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance),
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year) %>%
group_by(brood_year) %>%
dplyr::mutate(sum = sum(abundance),
percent = abundance/sum) %>%
dplyr::select(-abundance,-sum) %>%
spread(age,percent)
write_csv(yukon_summer,"data/age_comps/processed_age_comps_summer_yukon.csv")
summer_age_comp<-read_csv("data/age_comps/processed_age_comps_summer_yukon.csv")
View(summer_age_comp)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2)
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,6:9) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,6:9) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance")
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,6:9) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance))
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,6:9) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance)) %>%
spread(age, abundance)
View(yukon_summer)
library(tidyverse)
library(here)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
dplyr::select(1,6:9) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year") %>%
gather(2:5, key = "age", value = "abundance") %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
abundance = as.numeric(abundance)) %>%
spread(age, abundance)
#brood year age comps -----
# yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
#   dplyr::select(1,11:14) %>%
#   janitor::row_to_names(row_number = 1) %>%
#   dplyr::rename(cal_year = "Year") %>%
#   gather(2:5, key = "age", value = "abundance") %>%
#   dplyr::mutate(cal_year = as.numeric(cal_year),
#                 abundance = as.numeric(abundance),
#                 brood_year = case_when(age == "age3" ~ cal_year -3,
#                                  age == "age4" ~ cal_year -4,
#                                  age == "age5" ~ cal_year -5,
#                                  age == "age6" ~ cal_year -6)) %>%
#   dplyr::select(-cal_year) %>%
#   group_by(brood_year) %>%
#   dplyr::mutate(sum = sum(abundance),
#                 percent = abundance/sum) %>%
#   dplyr::select(-abundance,-sum) %>%
#   spread(age,percent)
write_csv(yukon_summer,"data/age_comps/processed_age_comps_summer_yukon.csv")
summer_age_comp<-read_csv("data/age_comps/processed_age_comps_summer_yukon.csv")
View(summer_age_comp)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year)) %>%
left_join(summer_age_comp)
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "abundance")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
mutate(abundance = percent*spawners)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
mutate(abundance = percent*spawners)
View(yukon_summer)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(-cal_year)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(brood_year, age, abundance)
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(brood_year, age, abundance) %>%
spread(age,abundance)
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners"
) %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age_3_abundance = abund_0.3 *spawners,
age_4_abundance = abund_0.4 *spawners,
age_5_abundance = abund_0.5 *spawners,
age_6_abundance = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age_3_abundance,age_4_abundance,age_5_abundance,age_6_abundance) %>%
gather(3:6, key = "id", value = "abundance")
# Make Spawner age comp =======
## Fall Yukon =======
# created in make_fall_yukon_age_comp.R - source from JTC report
fall_age_comp <-read_csv("data/age_comps/processed_age_comps_Fallyukon_source4.csv") %>%
dplyr::select(brood_year, age, percent) %>%
spread(age,percent)
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners"
) %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age_3_abundance = abund_0.3 *spawners,
age_4_abundance = abund_0.4 *spawners,
age_5_abundance = abund_0.5 *spawners,
age_6_abundance = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age_3_abundance,age_4_abundance,age_5_abundance,age_6_abundance) %>%
gather(3:6, key = "id", value = "abundance")
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners"
) %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age_3_abundance = abund_0.3 *spawners,
age_4_abundance = abund_0.4 *spawners,
age_5_abundance = abund_0.5 *spawners,
age_6_abundance = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age_3_abundance,age_4_abundance,age_5_abundance,age_6_abundance) %>%
gather(3:6, key = "id", value = "abundance") %>%
dplyr::select(brood_year, id, abundance) %>%
spread(id, abundance) %>%
dplyr::mutate(id = "fall")
## Summer Yukon =======
# sent to me separately, by Fred west 2-22-2024
summer_age_comp<-read_csv("data/age_comps/processed_age_comps_summer_yukon.csv")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(brood_year, age, abundance) %>%
spread(age,abundance) %>%
mutate(id = "summer")
yukon_spawners = rbind(yukon_fall, yukon_summer)
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners"
) %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age_3 = abund_0.3 *spawners,
age_4 = abund_0.4 *spawners,
age_5 = abund_0.5 *spawners,
age_6 = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age_3_abundance,age_4_abundance,age_5_abundance,age_6_abundance) %>%
gather(3:6, key = "id", value = "abundance") %>%
dplyr::select(brood_year, id, abundance) %>%
spread(id, abundance) %>%
dplyr::mutate(id = "fall")
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners") %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age_3 = abund_0.3 *spawners,
age_4 = abund_0.4 *spawners,
age_5 = abund_0.5 *spawners,
age_6 = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age_3,age_4,age_5,age_6) %>%
gather(3:6, key = "id", value = "abundance") %>%
dplyr::select(brood_year, id, abundance) %>%
spread(id, abundance) %>%
dplyr::mutate(id = "fall")
## Summer Yukon =======
# sent to me separately, by Fred west 2-22-2024
summer_age_comp<-read_csv("data/age_comps/processed_age_comps_summer_yukon.csv")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(brood_year, age, abundance) %>%
spread(age,abundance) %>%
mutate(id = "summer")
yukon_spawners = rbind(yukon_fall, yukon_summer)
yukon_fall<- read_csv("data/Yukon_Escapement_ADFG/Yukon_Fall_Chum_RR_JTC.csv")  %>%
rename(brood_year = "Year",
spawners = "Spawners") %>%
dplyr::select(brood_year, spawners) %>%
left_join(fall_age_comp) %>%
dplyr::mutate(age3 = abund_0.3 *spawners,
age4 = abund_0.4 *spawners,
age5 = abund_0.5 *spawners,
age6 = abund_0.6 *spawners) %>%
dplyr::select(brood_year, spawners,age3,age4,age5,age6) %>%
gather(3:6, key = "id", value = "abundance") %>%
dplyr::select(brood_year, id, abundance) %>%
spread(id, abundance) %>%
dplyr::mutate(id = "fall")
## Summer Yukon =======
# sent to me separately, by Fred west 2-22-2024
summer_age_comp<-read_csv("data/age_comps/processed_age_comps_summer_yukon.csv")
yukon_summer <- read_excel("data/Yukon_Escapement_ADFG/S Chum RR 2023.xlsx", sheet = 2) %>%
select(1,2) %>%
janitor::row_to_names(row_number = 1) %>%
dplyr::rename(cal_year = "Year",
spawners = "Escapement") %>%
dplyr::select(cal_year, spawners)  %>%
dplyr::mutate(cal_year = as.numeric(cal_year),
spawners = as.numeric(spawners)) %>%
left_join(summer_age_comp) %>%
gather(3:6, key = "age", value = "percent") %>%
dplyr::mutate(abundance = percent*spawners,
brood_year = case_when(age == "age3" ~ cal_year -3,
age == "age4" ~ cal_year -4,
age == "age5" ~ cal_year -5,
age == "age6" ~ cal_year -6)) %>%
dplyr::select(brood_year, age, abundance) %>%
spread(age,abundance) %>%
mutate(id = "summer")
yukon_spawners = rbind(yukon_fall, yukon_summer)
# Juveniles ========================================================
juv <- read_csv("data/Juv_Index_CC_aug2023/Index2.csv") %>%
dplyr::select(Time, Estimate) %>%
rename(Year = "Time")
View(yukon_spawners)
# QAQC PLOTS ===========
yukon_spawners %>%
gather(2:5, key = "key", value = "value") %>%
ggplot(aes(x = brood_year, y = value, color = key, fill =key)) +
geom_bar(position="stack", stat="identity" ) +
facet_wrap(~id)
# QAQC PLOTS ===========
yukon_spawners %>%
gather(2:5, key = "key", value = "value") %>%
ggplot(aes(x = brood_year, y = value, color = key, group =key)) +
geom_line() +
theme_classic( ) +
facet_wrap(~id)
yukon_spawners %>%
gather(2:5, key = "key", value = "value") %>%
ggplot(aes(x = brood_year, y = value, color = id, group =id)) +
geom_line() +
theme_classic( ) +
facet_wrap(~key)
yukon_spawners %>%
gather(2:5, key = "key", value = "value") %>%
ggplot(aes(x = brood_year, y = value, color = id, group =id)) +
geom_line() +
theme_classic( ) +
facet_wrap(~key, scales = "free")
