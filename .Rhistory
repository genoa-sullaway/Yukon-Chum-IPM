theme_bw()+
xlab("Longitude")+
ylab("Latitude")
Region_Map_RawData
#First filter for all data north of 60N
NBS_Zoop <- filter(AllZoop_Raw, LAT>=60)
#Now map again to take a look
#
# # make plot
# Region_Map_NBS_Process_1 <- ggplot()+
#
#   # add coastline
#   geom_sf(data = world)+
#     coord_sf(xlim = lons, ylim = lats, expand = FALSE)+
#
#   #Plot station points
#   geom_point(data=NBS_Zoop, mapping=aes(LON, LAT))+
#
#   # formatting
#   theme_bw()+
#   xlab("Longitude")+
#   ylab("Latitude")
#
# Region_Map_NBS_Process_1
#Looks like some data from the GOA is still present, so remove data > 155
NBS_Zoop <- filter(NBS_Zoop, LON<= -150)
#Now map again to take a look
#
# # make plot
# Region_Map_NBS_Process_2 <- ggplot()+
#
#   # add coastline
#   geom_sf(data = world)+
#     coord_sf(xlim = lons, ylim = lats, expand = FALSE)+
#
#   #Plot station points
#   geom_point(data=NBS_Zoop, mapping=aes(LON, LAT))+
#
#   # formatting
#   theme_bw()+
#   xlab("Longitude")+
#   ylab("Latitude")
#
# Region_Map_NBS_Process_2
#Spatial coverage looks correct
#Now check temporal coverage
sort(unique(NBS_Zoop$YEAR), decreasing = FALSE)
#Remove data from 1996 as it is removed from all other years of collection
NBS_Zoop <- filter(NBS_Zoop, YEAR!=1996)
#Take a look at the gears present in the dataset
unique(NBS_Zoop$GEAR_NAME)
unique(NBS_Zoop$MESH)
#Rough estimate of number of samples by gear type
NBS_Zoop_Gear <- NBS_Zoop[, c("CRUISE", "GEAR_NAME", "MESH", "LAT", "LON")]
NBS_Zoop_Gear <- distinct(NBS_Zoop_Gear)
NBS_Zoop_Gear_byGear <- group_by(NBS_Zoop_Gear, GEAR_NAME, MESH)
NBS_Gear_Summary <- summarise(NBS_Zoop_Gear_byGear, n())
ungroup(NBS_Zoop_Gear)
#This shows a few gears can be eliminated for low sample size (V60BON, 80BON) and CALVET has too small mesh size
NBS_Zoop <- filter(NBS_Zoop, GEAR_NAME!="CALVET")
NBS_Zoop <- filter(NBS_Zoop, GEAR_NAME!="V60BON")
NBS_Zoop <- filter(NBS_Zoop, GEAR_NAME!="80BON")
#Remove sled data as this is biased toward a bottom sample
NBS_Zoop <- filter(NBS_Zoop, GEAR_NAME!="SLED")
#Write this raw file prior to further processing
#write.csv(NBS_Zoop, here("data", "NBS_Zoop_Raw.csv"))
TaxaList_Coarse <- read.csv(here("data/TaxaList_Coarse.csv"))
#Now add this to the file
TaxaList_Coarse <- distinct(TaxaList_Coarse)
NBS_Zoop_Process <- left_join(NBS_Zoop, TaxaList_Coarse, by = "TAXON_NAME")
#Filter out those data marked for removal
NBS_Zoop_Process <- filter(NBS_Zoop_Process, NOTE != "Remove")
#Now take a look at the Coarse taxa
TaxaList_Coarse_Summary <- unique(sort(NBS_Zoop_Process$TAXA_COARSE, decreasing = FALSE))
TaxaList_Coarse_Summary <- as.data.frame(TaxaList_Coarse_Summary)
#Write this file
write.csv(TaxaList_Coarse_Summary, here("TaxaList_Coarse_Summary.csv"))
Acartia_spp <- filter(NBS_Zoop_Process, TAXA_COARSE=="Acartia spp.")
#Acartia is a small copepod, so all estimates should come from the smaller nets
#Filter for correct gear
Acartia_spp <- filter(Acartia_spp, GEAR_NAME!= "60BON")
Aglantha_digitale <- filter(NBS_Zoop_Process, TAXA_COARSE=="Aglantha digitale")
#Choose to estimate Cnidarians from the 60BON only
Aglantha_digitale <- filter(Aglantha_digitale, GEAR_NAME=="60BON")
Amphipoda <- filter(NBS_Zoop_Process, TAXA_COARSE=="Amphipoda")
#Amhipods will be estimated from the 60BON only
Amphipoda <- filter(Amphipoda, GEAR_NAME=="60BON")
Anomura <- filter(NBS_Zoop_Process, TAXA_COARSE=="Anomura")
#Anomura estimate from 60BON only
Anomura <- filter(Amphipoda, GEAR_NAME=="60BON")
Appendicularia <- filter(NBS_Zoop_Process, TAXA_COARSE=="Appendicularia")
#Can filter for both gears and then add a taxa coarse of Appendicularia_large and Appendicular_small
Appendicularia_large <- filter(Appendicularia, GEAR_NAME=="60BON")
#Recode coarse taxa
Appendicularia_large$TAXA_COARSE[Appendicularia_large$TAXA_COARSE=="Appendicularia"] <- "Appendicularia_large"
Appendicularia_small <- filter(Appendicularia, GEAR_NAME!="60BON")
#Recode coarse taxa
Appendicularia_small$TAXA_COARSE[Appendicularia_small$TAXA_COARSE=="Appendicularia"] <- "Appendicularia_small"
Bivalvia <- filter(NBS_Zoop_Process, TAXA_COARSE=="Bivalvia")
#Bivalvia estimate from smaller nets only
Bivalvia <- filter(Bivalvia, GEAR_NAME!="60BON")
Brachyura <- filter(NBS_Zoop_Process, TAXA_COARSE=="Brachyura")
#Brachyura estimate from 60BON only
Brachyura <- filter(Brachyura, GEAR_NAME=="60BON")
Calanus_hyperboreus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Calanus hyperboreus")
#Separate EMA data as they were sorted under different protocols
Calanus_hyperboreus_EMA <- filter(Calanus_hyperboreus, DATA_SOURCE=="EMA")
Calanus_hyperboreus_EcoDAAT <- filter(Calanus_hyperboreus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Calanus_hyperboreus_EcoDAAT_bySPECIMEN_FORM <- group_by(Calanus_hyperboreus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Calanus_hyperboreus_EcoDAAT_FormSummary <- summarise(Calanus_hyperboreus_EcoDAAT_bySPECIMEN_FORM,n())
#These look correct
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Calanus_hyperboreus_EMA_byGEAR_NAME <- group_by(Calanus_hyperboreus_EMA, MESH, GEAR_NAME)
Calanus_hyperboreus_EMA_GearSummary <- summarise(Calanus_hyperboreus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Calanus_hyperboreus_EMA <- filter(Calanus_hyperboreus_EMA, MESH != 153)
#The other gears are correct, so rebuild dataset
Calanus_hyperboreus <- rbind(Calanus_hyperboreus_EcoDAAT, Calanus_hyperboreus_EMA)
Calanus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Calanus marshallae/glacialis")
#Separate EMA data as they were sorted under different protocols
Calanus_EMA <- filter(Calanus, DATA_SOURCE=="EMA")
Calanus_EcoDAAT <- filter(Calanus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Calanus_EcoDAAT_bySPECIMEN_FORM <- group_by(Calanus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Calanus_EcoDAAT_FormSummary <- summarise(Calanus_EcoDAAT_bySPECIMEN_FORM,n())
#Do some filtering to get the correct stages from the correct gear for EcoDAAT data
Calanus_EcoDAAT_B <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="B")
Calanus_EcoDAAT_B <- filter(Calanus_EcoDAAT_B, MESH!=153)
Calanus_EcoDAAT_C <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="C")
Calanus_EcoDAAT_C <- filter(Calanus_EcoDAAT_C, MESH==153)
Calanus_EcoDAAT_C <- filter(Calanus_EcoDAAT_C, GEAR_NAME=="20BON")
Calanus_EcoDAAT_G <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="G")
Calanus_EcoDAAT_H <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="H")
Calanus_EcoDAAT_K <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="K")
Calanus_EcoDAAT_L <- filter(Calanus_EcoDAAT, SPECIMEN_FORM=="L")
#The other gears are correct, so rebuild dataset
Calanus_EcoDAAT_Final <- rbind(Calanus_EcoDAAT_B, Calanus_EcoDAAT_C, Calanus_EcoDAAT_G, Calanus_EcoDAAT_H, Calanus_EcoDAAT_K, Calanus_EcoDAAT_L)
ungroup(Calanus_EcoDAAT_Final)
#Remove some files
rm(Calanus_EcoDAAT_bySPECIMEN_FORM, Calanus_EcoDAAT_B, Calanus_EcoDAAT_C, Calanus_EcoDAAT_G, Calanus_EcoDAAT_H, Calanus_EcoDAAT_K, Calanus_EcoDAAT_L)
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Calanus_EMA_byGEAR_NAME <- group_by(Calanus_EMA, MESH, GEAR_NAME)
Calanus_EMA_GearSummary <- summarise(Calanus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Calanus_EMA_60BON <- filter(Calanus_EMA, GEAR_NAME=="60BON")
Calanus_EMA_60BON_333 <- filter(Calanus_EMA_60BON, MESH==333)
Calanus_EMA_60BON_333 <- filter(Calanus_EMA_60BON_333, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
Calanus_EMA_60BON_505 <- filter(Calanus_EMA_60BON, MESH==505)
Calanus_EMA_60BON_505 <- filter(Calanus_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)")
Calanus_EMA_20BON <- filter(Calanus_EMA, GEAR_NAME=="20BON")
Calanus_EMA_20BON_153 <- filter(Calanus_EMA_20BON, MESH==153)
Calanus_EMA_20BON_153 <- filter(Calanus_EMA_20BON_153, STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 1 (COPEPODITE I)")
#The other gears are correct, so rebuild dataset
Calanus_EMA_Final <- rbind(Calanus_EMA_60BON_333, Calanus_EMA_60BON_505, Calanus_EMA_20BON_153)
ungroup(Calanus_EMA_Final)
#Remove some files
rm(Calanus_EMA_byGEAR_NAME, Calanus_EMA_20BON, Calanus_EMA_20BON_153, Calanus_EMA_60BON, Calanus_EMA_60BON_333, Calanus_EMA_60BON_505)
#Combine into final, Calanus data set
Calanus <- rbind(Calanus_EMA_Final, Calanus_EcoDAAT_Final)
Calanus_pacificus <- filter(NBS_Zoop_Process, TAXA_COARSE == "Calanus pacificus")
Cristatus <- filter(NBS_Zoop_Process, TAXON_NAME=="Neocalanus cristatus")
Cristatus_EMA <- filter(Cristatus, DATA_SOURCE=="EMA")
Cristatus_EcoDAAT <- filter(Cristatus, DATA_SOURCE=="EcoDAAT")
Cristatus_EcoDAAT_bySPECIMEN_FORM <- group_by(Cristatus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Cristatus_EcoDAAT_FormSummary <- summarise(Cristatus_EcoDAAT_bySPECIMEN_FORM,n())
Cristatus_EcoDAAT_A <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="A")
Cristatus_EcoDAAT_A <- filter(Cristatus_EcoDAAT_A, MESH!=153)
Cristatus_EcoDAAT_B <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="B")
Cristatus_EcoDAAT_B <- filter(Cristatus_EcoDAAT_B, MESH!=153)
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="C")
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT_C, MESH==153)
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT_C, GEAR_NAME=="20BON")
Cristatus_EcoDAAT_F <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="F")
Cristatus_EcoDAAT_G <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="G")
Cristatus_EcoDAAT_H <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="H")
Cristatus_EcoDAAT_K <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="K")
Cristatus_EcoDAAT_L <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="L")
Cristatus_EcoDAAT_Final <- rbind(Cristatus_EcoDAAT_A, Cristatus_EcoDAAT_B, Cristatus_EcoDAAT_C, Cristatus_EcoDAAT_F, Cristatus_EcoDAAT_G, Cristatus_EcoDAAT_H, Cristatus_EcoDAAT_K, Cristatus_EcoDAAT_L)
ungroup(Cristatus_EcoDAAT_Final)
rm(Cristatus_EcoDAAT_bySPECIMEN_FORM, Cristatus_EcoDAAT_A, Cristatus_EcoDAAT_B, Cristatus_EcoDAAT_C, Cristatus_EcoDAAT_F, Cristatus_EcoDAAT_G, Cristatus_EcoDAAT_H, Cristatus_EcoDAAT_K, Cristatus_EcoDAAT_L)
Cristatus_EMA_byGEAR_NAME <- group_by(Cristatus_EMA, MESH, GEAR_NAME)
Cristatus_EMA_GearSummary <- summarise(Cristatus_EMA_byGEAR_NAME, n())
Cristatus_EMA_Final <-  filter(Cristatus_EMA, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
ungroup(Cristatus_EMA_Final)
HAUL_ID <- filter(NBS_Zoop_Process, GEAR_NAME=="20BON"|GEAR_NAME=="60BON")
HAUL_ID <- filter(HAUL_ID, DATA_SOURCE=="EcoDAAT")
HAUL_ID <- filter(HAUL_ID, SPECIMEN_FORM=="F"|SPECIMEN_FORM=="G"|SPECIMEN_FORM=="H"|SPECIMEN_FORM=="K"|SPECIMEN_FORM=="L")
HAUL_ID <- HAUL_ID[, "HAUL_ID"]
HAUL_ID <- distinct(HAUL_ID)
Cristatus_EcoDAAT_Final_NoZero <- filter(Cristatus_EcoDAAT_Final, SPECIMEN_FORM=="F"|SPECIMEN_FORM=="G"|SPECIMEN_FORM=="H"|SPECIMEN_FORM=="K"|SPECIMEN_FORM=="L")
Cristatus_EcoDAAT_Final_NoZero_HAUL_ID <- Cristatus_EcoDAAT_Final_NoZero[, c("HAUL_ID", "GEAR_NAME", "SPECIMEN_FORM")]
Cristatus_EcoDAAT_Final_NoZero_HAUL_ID <- distinct(Cristatus_EcoDAAT_Final_NoZero_HAUL_ID)
HAUL_ID_join <- left_join(HAUL_ID, Cristatus_EcoDAAT_Final_NoZero_HAUL_ID, by = "HAUL_ID")
HAUL_ID_ZeroHauls <- filter(HAUL_ID_join, is.na(GEAR_NAME))
HAUL_ID_ZeroHauls$GEAR_NAME <- str_match(HAUL_ID_ZeroHauls$HAUL_ID, "20BON")
HAUL_ID_ZeroHauls$GEAR_NAME <- HAUL_ID_ZeroHauls$GEAR_NAME %>% replace_na("60BON")
HAUL_ID_ZeroHauls$EST_NUM_PERM2 <- NA
HAUL_ID_ZeroHauls$EST_NUM_PERM3 <- NA
HAUL_ID_ZeroHauls$SEX_NAME <- NA
HAUL_ID_ZeroHauls$STAGE_NAME <- NA
HAUL_ID_ZeroHauls$SIZE_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls$TAXON_NAME <- "Neocalanus cristatus"
HAUL_ID_ZeroHauls_C1 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C2 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C3 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C4 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C5 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_ADULT_F <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_ADULT_M <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C1 <- filter(HAUL_ID_ZeroHauls_C1, GEAR_NAME=="20BON")
HAUL_ID_ZeroHauls_C1$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C1$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C1$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C1$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C1$STAGE_NAME <- "C - 1 (COPEPODITE I)"
HAUL_ID_ZeroHauls_C2 <- filter(HAUL_ID_ZeroHauls_C2, GEAR_NAME=="20BON")
HAUL_ID_ZeroHauls_C2$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C2$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C2$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C2$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C2$STAGE_NAME <- "C - 2 (COPEPODITE II)"
HAUL_ID_ZeroHauls_C3 <- filter(HAUL_ID_ZeroHauls_C3, GEAR_NAME=="20BON")
HAUL_ID_ZeroHauls_C3$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C3$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C3$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C3$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C3$STAGE_NAME <- "C - 3 (COPEPODITE III)"
HAUL_ID_ZeroHauls_C4 <- filter(HAUL_ID_ZeroHauls_C4, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_C4$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C4$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C4$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C4$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C4$STAGE_NAME <- "C - 4 (COPEPODITE IV)"
HAUL_ID_ZeroHauls_C5 <- filter(HAUL_ID_ZeroHauls_C5, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_C5$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C5$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C5$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C5$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C5$STAGE_NAME <- "C - 5 (COPEPODITE V)"
HAUL_ID_ZeroHauls_ADULT_F <- filter(HAUL_ID_ZeroHauls_ADULT_F, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_ADULT_F$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_ADULT_F$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_ADULT_F$SEX_NAME <- "FEMALE"
HAUL_ID_ZeroHauls_ADULT_F$SEX_NAME <- "FEMALE"
HAUL_ID_ZeroHauls_ADULT_F$STAGE_NAME <- "ADULT"
HAUL_ID_ZeroHauls_ADULT_M <- filter(HAUL_ID_ZeroHauls_ADULT_M, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_ADULT_M$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_ADULT_M$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_ADULT_M$SEX_NAME <- "MALE"
HAUL_ID_ZeroHauls_ADULT_M$SEX_NAME <- "MALE"
HAUL_ID_ZeroHauls_ADULT_M$STAGE_NAME <- "ADULT"
HAUL_ID_Zero_Hauls <- rbind(HAUL_ID_ZeroHauls_C1, HAUL_ID_ZeroHauls_C2, HAUL_ID_ZeroHauls_C3, HAUL_ID_ZeroHauls_C4, HAUL_ID_ZeroHauls_C5, HAUL_ID_ZeroHauls_ADULT_F, HAUL_ID_ZeroHauls_ADULT_M)
Hauls_Zero_Zoop <- left_join(HAUL_ID_Zero_Hauls, NBS_Zoop_Process, by = "HAUL_ID")
Hauls_Zero_Zoop <- Hauls_Zero_Zoop[, c("BOTTOM_DEPTH", "CRUISE", "DAY", "EST_NUM_PERM2.x", "EST_NUM_PERM3.x", "GEAR_NAME.x", "GMT_DATE_TIME_TXT", "HAUL_ID", "HAUL_PERFORMANCE", "LAT", "LON", "MAX_GEAR_DEPTH", "MESH", "MONTH", "SPECIMEN_FORM.x", "SEX_NAME.x", "SIZE_NAME.x", "STAGE_NAME.x", "STATION_NAME", "TAXON_NAME.x", "VOLUME_FILTERED", "YEAR", "DATA_SOURCE" )]
Hauls_Zero_Zoop <- rename(Hauls_Zero_Zoop, EST_NUM_PERM2 = EST_NUM_PERM2.x, EST_NUM_PERM3 = EST_NUM_PERM3.x, GEAR_NAME = GEAR_NAME.x, SEX_NAME = SEX_NAME.x, TAXON_NAME = TAXON_NAME.x, SIZE_NAME = SIZE_NAME.x, STAGE_NAME = STAGE_NAME.x, SPECIMEN_FORM = SPECIMEN_FORM.x)
Hauls_Zero_Zoop <- distinct(Hauls_Zero_Zoop)
Cristatus_EcoDAAT_Final <- rbind(Cristatus_EcoDAAT_Final, Hauls_Zero_Zoop)
#Now we ca add the stations with zeros to the original data
compare_df_cols(Cristatus_EcoDAAT_Final, Hauls_Zero_Zoop)
#Now we ca add the stations with zeros to the original data
t<-compare_df_cols(Cristatus_EcoDAAT_Final, Hauls_Zero_Zoop)
Hauls_Zero_Zoop <- left_join(HAUL_ID_Zero_Hauls, NBS_Zoop_Process, by = "HAUL_ID")
Hauls_Zero_Zoop <- Hauls_Zero_Zoop[, c("BOTTOM_DEPTH", "CRUISE", "DAY", "EST_NUM_PERM2.x", "EST_NUM_PERM3.x", "GEAR_NAME.x", "GMT_DATE_TIME_TXT", "HAUL_ID", "HAUL_PERFORMANCE", "LAT", "LON", "MAX_GEAR_DEPTH", "MESH", "MONTH", "SPECIMEN_FORM.x", "SEX_NAME.x", "SIZE_NAME.x", "STAGE_NAME.x", "STATION_NAME", "TAXON_NAME.x", "VOLUME_FILTERED", "YEAR", "DATA_SOURCE", "NOTE", "TAXA_COARSE" )]
Hauls_Zero_Zoop <- rename(Hauls_Zero_Zoop, EST_NUM_PERM2 = EST_NUM_PERM2.x, EST_NUM_PERM3 = EST_NUM_PERM3.x, GEAR_NAME = GEAR_NAME.x, SEX_NAME = SEX_NAME.x, TAXON_NAME = TAXON_NAME.x, SIZE_NAME = SIZE_NAME.x, STAGE_NAME = STAGE_NAME.x, SPECIMEN_FORM = SPECIMEN_FORM.x)
Hauls_Zero_Zoop <- distinct(Hauls_Zero_Zoop)
Cristatus_EcoDAAT_Final <- rbind(Cristatus_EcoDAAT_Final, Hauls_Zero_Zoop)
Cristatus_Final <- rbind(Cristatus_EMA_Final, Cristatus_EcoDAAT_Final)
Cristatus_Final$IND_MASS_MG_WWT <- NA
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="C - 1 (COPEPODITE I)"] <- 0.064418596
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="C - 2 (COPEPODITE II)"] <- 0.248329292
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="C - 3 (COPEPODITE III)"] <- 1.025961448
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="C - 4 (COPEPODITE IV)"] <- 3.97848981
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="C - 5 (COPEPODITE V)"] <- 13.1379793
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="ADULT"&Cristatus_Final$SEX_NAME=="FEMALE"] <- 37.5323453182045
Cristatus_Final$IND_MASS_MG_WWT[Cristatus_Final$STAGE_NAME=="ADULT"&Cristatus_Final$SEX_NAME=="MALE"] <- 27.67241752
Cristatus_Final$EST_MG_PERM2_WWT <- Cristatus_Final$EST_NUM_PERM2*Cristatus_Final$IND_MASS_MG_WWT
Cristatus_Final$EST_MG_PERM3_WWT <- Cristatus_Final$EST_NUM_PERM3*Cristatus_Final$IND_MASS_MG_WWT
Neocalanus <- filter(NBS_Zoop_Process, TAXON_NAME=="Neocalanus plumchrus"|TAXON_NAME=="Neocalanus flemingeri"|TAXON_NAME=="Neocalanus spp.")
Neocalanus_EMA <- filter(Neocalanus, DATA_SOURCE=="EMA")
Neocalanus_EcoDAAT <- filter(Neocalanus, DATA_SOURCE=="EcoDAAT")
Neocalanus_EcoDAAT_bySPECIMEN_FORM <- group_by(Neocalanus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Neocalanus_EcoDAAT_FormSummary <- summarise(Neocalanus_EcoDAAT_bySPECIMEN_FORM,n())
Neocalanus_EcoDAAT_B <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="B")
Neocalanus_EcoDAAT_B <- filter(Neocalanus_EcoDAAT_B, MESH!=153)
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="C")
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT_C, MESH==153)
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT_C, GEAR_NAME=="20BON")
Neocalanus_EcoDAAT_G <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="G")
Neocalanus_EcoDAAT_H <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="H")
Neocalanus_EcoDAAT_K <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="K")
Neocalanus_EcoDAAT_L <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="L")
Neocalanus_EcoDAAT_Final <- rbind(Neocalanus_EcoDAAT_B, Neocalanus_EcoDAAT_C, Neocalanus_EcoDAAT_G, Neocalanus_EcoDAAT_H, Neocalanus_EcoDAAT_K, Neocalanus_EcoDAAT_L)
ungroup(Neocalanus_EcoDAAT_Final)
rm(Neocalanus_EcoDAAT_bySPECIMEN_FORM, Neocalanus_EcoDAAT_B, Neocalanus_EcoDAAT_C, Neocalanus_EcoDAAT_G, Neocalanus_EcoDAAT_H, Neocalanus_EcoDAAT_K, Neocalanus_EcoDAAT_L)
Neocalanus_EMA_byGEAR_NAME <- group_by(Neocalanus_EMA, MESH, GEAR_NAME)
Neocalanus_EMA_GearSummary <- summarise(Neocalanus_EMA_byGEAR_NAME, n())
Neocalanus_EMA_Final <-  filter(Neocalanus_EMA, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
ungroup(Neocalanus_EMA_Final)
HAUL_ID <- filter(NBS_Zoop_Process, GEAR_NAME=="20BON"|GEAR_NAME=="60BON")
HAUL_ID <- filter(HAUL_ID, DATA_SOURCE=="EcoDAAT")
HAUL_ID <- filter(HAUL_ID, SPECIMEN_FORM=="G"|SPECIMEN_FORM=="H"|SPECIMEN_FORM=="K"|SPECIMEN_FORM=="L")
HAUL_ID <- HAUL_ID[, "HAUL_ID"]
HAUL_ID <- distinct(HAUL_ID)
Neocalanus_EcoDAAT_Final_NoZero <- filter(Neocalanus_EcoDAAT_Final,  SPECIMEN_FORM=="G"|SPECIMEN_FORM=="H"|SPECIMEN_FORM=="K"|SPECIMEN_FORM=="L")
Neocalanus_EcoDAAT_Final_NoZero_HAUL_ID <- Neocalanus_EcoDAAT_Final_NoZero[, c("HAUL_ID", "GEAR_NAME", "SPECIMEN_FORM")]
Neocalanus_EcoDAAT_Final_NoZero_HAUL_ID <- distinct(Neocalanus_EcoDAAT_Final_NoZero_HAUL_ID)
HAUL_ID_join <- left_join(HAUL_ID, Neocalanus_EcoDAAT_Final_NoZero_HAUL_ID, by = "HAUL_ID")
HAUL_ID_ZeroHauls <- filter(HAUL_ID_join, is.na(GEAR_NAME))
HAUL_ID_ZeroHauls$GEAR_NAME <- str_match(HAUL_ID_ZeroHauls$HAUL_ID, "20BON")
HAUL_ID_ZeroHauls$GEAR_NAME <- HAUL_ID_ZeroHauls$GEAR_NAME %>% replace_na("60BON")
HAUL_ID_ZeroHauls$EST_NUM_PERM2 <- NA
HAUL_ID_ZeroHauls$EST_NUM_PERM3 <- NA
HAUL_ID_ZeroHauls$SEX_NAME <- NA
HAUL_ID_ZeroHauls$STAGE_NAME <- NA
HAUL_ID_ZeroHauls$SIZE_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls$TAXON_NAME <- "Neocalanus spp."
HAUL_ID_ZeroHauls_C1 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C2 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C3 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C4 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C5 <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_ADULT_F <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_ADULT_M <- HAUL_ID_ZeroHauls
HAUL_ID_ZeroHauls_C1 <- filter(HAUL_ID_ZeroHauls_C1, GEAR_NAME=="20BON")
HAUL_ID_ZeroHauls_C1$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C1$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C1$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C1$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C1$STAGE_NAME <- "C - 1 (COPEPODITE I)"
HAUL_ID_ZeroHauls_C2 <- filter(HAUL_ID_ZeroHauls_C2, GEAR_NAME=="20BON")
HAUL_ID_ZeroHauls_C2$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C2$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C2$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C2$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C2$STAGE_NAME <- "C - 2 (COPEPODITE II)"
HAUL_ID_ZeroHauls_C3 <- filter(HAUL_ID_ZeroHauls_C3, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_C3$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C3$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C3$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C3$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C3$STAGE_NAME <- "C - 3 (COPEPODITE III)"
HAUL_ID_ZeroHauls_C4 <- filter(HAUL_ID_ZeroHauls_C4, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_C4$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C4$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C4$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C4$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C4$STAGE_NAME <- "C - 4 (COPEPODITE IV)"
HAUL_ID_ZeroHauls_C5 <- filter(HAUL_ID_ZeroHauls_C5, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_C5$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_C5$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_C5$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C5$SEX_NAME <- "NOT DETERMINED"
HAUL_ID_ZeroHauls_C5$STAGE_NAME <- "C - 5 (COPEPODITE V)"
HAUL_ID_ZeroHauls_ADULT_F <- filter(HAUL_ID_ZeroHauls_ADULT_F, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_ADULT_F$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_ADULT_F$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_ADULT_F$SEX_NAME <- "FEMALE"
HAUL_ID_ZeroHauls_ADULT_F$SEX_NAME <- "FEMALE"
HAUL_ID_ZeroHauls_ADULT_F$STAGE_NAME <- "ADULT"
HAUL_ID_ZeroHauls_ADULT_M <- filter(HAUL_ID_ZeroHauls_ADULT_M, GEAR_NAME=="60BON")
HAUL_ID_ZeroHauls_ADULT_M$EST_NUM_PERM2 <- 0
HAUL_ID_ZeroHauls_ADULT_M$EST_NUM_PERM3 <- 0
HAUL_ID_ZeroHauls_ADULT_M$SEX_NAME <- "MALE"
HAUL_ID_ZeroHauls_ADULT_M$SEX_NAME <- "MALE"
HAUL_ID_ZeroHauls_ADULT_M$STAGE_NAME <- "ADULT"
HAUL_ID_Zero_Hauls <- rbind(HAUL_ID_ZeroHauls_C1, HAUL_ID_ZeroHauls_C2, HAUL_ID_ZeroHauls_C3, HAUL_ID_ZeroHauls_C4, HAUL_ID_ZeroHauls_C5, HAUL_ID_ZeroHauls_ADULT_F, HAUL_ID_ZeroHauls_ADULT_M)
Hauls_Zero_Zoop <- left_join (HAUL_ID_Zero_Hauls, NBS_Zoop_Process, by = "HAUL_ID")
Hauls_Zero_Zoop <- Hauls_Zero_Zoop[, c("BOTTOM_DEPTH", "CRUISE", "DAY", "EST_NUM_PERM2.x", "EST_NUM_PERM3.x", "GEAR_NAME.x", "GMT_DATE_TIME_TXT", "HAUL_ID", "HAUL_PERFORMANCE", "LAT", "LON", "MAX_GEAR_DEPTH", "MESH", "MONTH", "SPECIMEN_FORM.x", "SEX_NAME.x", "SIZE_NAME.x", "STAGE_NAME.x", "STATION_NAME", "TAXON_NAME.x", "VOLUME_FILTERED", "YEAR", "DATA_SOURCE" )]
Hauls_Zero_Zoop <- rename(Hauls_Zero_Zoop, EST_NUM_PERM2 = EST_NUM_PERM2.x, EST_NUM_PERM3 = EST_NUM_PERM3.x, GEAR_NAME = GEAR_NAME.x, SEX_NAME = SEX_NAME.x, TAXON_NAME = TAXON_NAME.x, SIZE_NAME = SIZE_NAME.x, STAGE_NAME = STAGE_NAME.x, SPECIMEN_FORM = SPECIMEN_FORM.x)
Hauls_Zero_Zoop <- distinct(Hauls_Zero_Zoop)
Neocalanus_EcoDAAT_Final <- rbind(Neocalanus_EcoDAAT_Final, Hauls_Zero_Zoop)
Hauls_Zero_Zoop <- left_join (HAUL_ID_Zero_Hauls, NBS_Zoop_Process, by = "HAUL_ID")
Hauls_Zero_Zoop <- Hauls_Zero_Zoop[, c("BOTTOM_DEPTH", "CRUISE", "DAY", "EST_NUM_PERM2.x", "EST_NUM_PERM3.x", "GEAR_NAME.x", "GMT_DATE_TIME_TXT", "HAUL_ID", "HAUL_PERFORMANCE", "LAT", "LON", "MAX_GEAR_DEPTH", "MESH", "MONTH", "SPECIMEN_FORM.x", "SEX_NAME.x", "SIZE_NAME.x", "STAGE_NAME.x", "STATION_NAME", "TAXON_NAME.x", "VOLUME_FILTERED", "YEAR", "DATA_SOURCE", "NOTE", "TAXA_COARSE" )]
Hauls_Zero_Zoop <- rename(Hauls_Zero_Zoop, EST_NUM_PERM2 = EST_NUM_PERM2.x, EST_NUM_PERM3 = EST_NUM_PERM3.x, GEAR_NAME = GEAR_NAME.x, SEX_NAME = SEX_NAME.x, TAXON_NAME = TAXON_NAME.x, SIZE_NAME = SIZE_NAME.x, STAGE_NAME = STAGE_NAME.x, SPECIMEN_FORM = SPECIMEN_FORM.x)
Hauls_Zero_Zoop <- distinct(Hauls_Zero_Zoop)
Neocalanus_EcoDAAT_Final <- rbind(Neocalanus_EcoDAAT_Final, Hauls_Zero_Zoop)
Neocalanus_Final <- rbind(Neocalanus_EMA_Final, Neocalanus_EcoDAAT_Final)
Neocalanus_Final$IND_MASS_MG_WWT <- NA
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="C - 1 (COPEPODITE I)"] <- 0.032227755
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="C - 2 (COPEPODITE II)"] <- 0.107679288
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="C - 3 (COPEPODITE III)"] <- 0.353487784
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="C - 4 (COPEPODITE IV)"] <- 1.057848952
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="C - 5 (COPEPODITE V)"] <- 2.66466175
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="ADULT"&Neocalanus_Final$SEX_NAME=="FEMALE"] <- 3.173667243
Neocalanus_Final$IND_MASS_MG_WWT[Neocalanus_Final$STAGE_NAME=="ADULT"&Neocalanus_Final$SEX_NAME=="MALE"] <- 1.594736542
Neocalanus_Final$EST_MG_PERM2_WWT <- Neocalanus_Final$EST_NUM_PERM2*Neocalanus_Final$IND_MASS_MG_WWT
Neocalanus_Final$EST_MG_PERM3_WWT <- Neocalanus_Final$EST_NUM_PERM3*Neocalanus_Final$IND_MASS_MG_WWT
Species_Processed <- rbind(Calanus_Final, Cristatus_Final, Neocalanus_Final)
Calanus_Final <- rbind(Calanus_EMA_Final, Calanus_EcoDAAT_Final)
Species_Processed <- rbind(Calanus_Final, Cristatus_Final, Neocalanus_Final)
t<-compare_df_cols(Calanus_Final, Cristatus_Final, Neocalanus_Final)
View(t)
View(t)
#ADD 2 cols so they bind, may have to revisit later
Calanus_Final <- Calanus_Final %>%
dplyr::mutate(EST_MG_PERM3_WWT = NA,
EST_MG_PERM2_WWT = NA)
View(Calanus_Final)
Species_Processed <- rbind(Calanus_Final, Cristatus_Final, Neocalanus_Final)
t<-compare_df_cols(Calanus_Final, Cristatus_Final, Neocalanus_Final)
View(t)
```{r}
#ADD 2 cols so they bind, may have to revisit later
Calanus_Final <- Calanus_Final %>%
dplyr::mutate(EST_MG_PERM3_WWT = NA,
EST_MG_PERM2_WWT = NA,
IND_MASS_MG_WWT = NA)
Species_Processed <- rbind(Calanus_Final, Cristatus_Final, Neocalanus_Final)
write.csv(Species_Processed, here("data", "Species_Processed_Final.csv"))
#load zoop data
zoop <- read_csv("data/Species_Processed_Final.csv")
View(zoop)
unique(zoop$TAXA_COARSE)
#load zoop data
zoop <- read_csv("data/Species_Processed_Final.csv") %>%
filter(TAXA_COARSE == "Calanus marshallae/glacialis")
View(zoop)
#load zoop data
zoop <- read_csv("data/Species_Processed_Final.csv") %>%
filter(TAXA_COARSE == "Calanus marshallae/glacialis",
YEAR == 2018)
View(zoop)
# load 2018 lipid data
lipid <- read.csv("data/2018 Copepod data QA CP.csv") %>%
dplyr::select(Latitude, Longitude, estimated...lipid..dry.weight) %>%
dplyr::rename("proportion_lipid_dw" = estimated...lipid..dry.weight)
View(lipid)
hist(lipid$proportion_lipid_dw)
hist(log(lipid$proportion_lipid_dw))
mean_lipid <- mean(lipid$proportion_lipid_dw)
mean_lipid
mean_lipid <- mean(log(lipid$proportion_lipid_dw))
mean_lipid
# load 2018 lipid data
lipid <- read.csv("data/2018 Copepod data QA CP.csv") %>%
dplyr::select(Latitude, Longitude, estimated...lipid..dry.weight) %>%
dplyr::rename("proportion_lipid_dw" = estimated...lipid..dry.weight) %>%
filter(!is.na(proportion_lipid_dw))
hist(log(lipid$proportion_lipid_dw))
mean_lipid <- mean(log(lipid$proportion_lipid_dw))
mean_lipid
var_lipid <- var(log(lipid$proportion_lipid_dw))
sd_lipid <- sd(log(lipid$proportion_lipid_dw))
cal_lipid_draw <- rnorm(n=100, mean = mean_lipid, sd = sd_lipid)
cal_lipid_draw
ggplot(data = lipid)
ggplot(data = lipid) +
geom_hist(aes(x=log(proportion_lipid_dw))) +
geom_vline(xintercept = mean_lipid)
ggplot(data = lipid) +
geom_hist(aes(x=log(proportion_lipid_dw))) +
geom_vline(xintercept = mean_lipid)
ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw))) +
geom_vline(xintercept = mean_lipid)
ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw)), bins =20) +
geom_vline(xintercept = mean_lipid)
ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw)), bins =10) +
geom_vline(xintercept = mean_lipid)
ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw)), bins =7) +
geom_vline(xintercept = mean_lipid)
cal_lipid_draw
cal_lipid_draw <- data.frame(x= rnorm(n=100, mean = mean_lipid, sd = sd_lipid))
View(cal_lipid_draw)
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), bins =7)
p <- ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw)), bins =7) +
geom_vline(xintercept = mean_lipid)
p
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), bins =7)
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpah = 0.5, color = "red")
p <- ggplot(data = lipid) +
geom_histogram(aes(x=log(proportion_lipid_dw)), color = "black") +
geom_vline(xintercept = mean_lipid)
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpah = 0.5, color = "red")
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpha = 0.5, color = "red")
cal_lipid_draw <- data.frame(x= rnorm(n=1000, mean = mean_lipid, sd = sd_lipid))
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpha = 0.5, color = "red")
cal_lipid_draw <- data.frame(x= rnorm(n=49, mean = mean_lipid, sd = sd_lipid))
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpha = 0.5, color = "red")
mean(cal_lipid_draw$proportion_lipid_dw)
sd(cal_lipid_draw$proportion_lipid_dw)
cal_lipid_draw <- data.frame(x= rnorm(n=49, mean = mean_lipid, sd = sd_lipid))
mean(cal_lipid_draw$x)
sd(cal_lipid_draw$x)
mean_lipid
sd_lipid
p +
geom_histogram(data = cal_lipid_draw,
aes(x=x), alpha = 0.5, color = "red") +
geom_vline(xintercept = mean(cal_lipid_draw$x), color = "red")
View(zoop)
