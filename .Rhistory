dplyr::select(Year, Chum_hatchery)
hatchery_pink_b <- read_csv("output/hatchery_Pink_Covariate_AKandAsia.csv") %>%
dplyr::rename(Pink_hatchery="sum") %>%
dplyr::select(Year, Pink_hatchery)
sst_b<-read_csv("data/processed_covariates/Stage_B_CDD.csv") %>%
dplyr::rename(SST_CDD_SEBS = "CDD",
Year = "year") %>%
dplyr::select(Year, SST_CDD_SEBS)
river_discharge_b <- read_csv("data/processed_covariates/Stage_B_YK_Discharge.csv") %>%
dplyr::select(Year, mean_discharge,id) %>%
spread(id, mean_discharge) %>%
rename(kusko_mean_discharge_summer = "Kusko",
yukon_mean_discharge_summer = "Yukon")
stage_b_cov<- left_join(river_discharge_b,sst_b)  %>%
left_join(hatchery_pink_b) %>%
left_join(hatchery_chum_b)
# Stage B - Save DF =============
write_csv(stage_b_cov, "data/processed_covariates/stage_b_all.csv")
# Stage B - Plots =============
stage_b_cov_plot<-stage_b_cov %>%
gather(2:6, key = "id", value = "value") %>%
dplyr::mutate(id = factor(id, levels = c("SST_CDD_SEBS",
"Chum_hatchery",
"Pink_hatchery",
"kusko_mean_discharge_summer",
"yukon_mean_discharge_summer" )))
plotb <- ggplot(data = stage_b_cov_plot, aes(x=Year, y = value, color = id, group = id)) +
geom_point( ) +
geom_line( ) +
scale_color_manual(guide = "none", values = PNWColors::pnw_palette(name="Sunset2",n=5)) +
facet_wrap(~id, scales = "free",ncol=1) +
theme_classic()  +
ylab(" ") +
ggtitle("Stage B Covariates")
plotb
pdf("output/plot_covariates_b.pdf", width = 7, height = 12)
plotb
dev.off()
# Covariates B - scale ==========
stage_b_cov_plot <- stage_b_cov_plot %>%
group_by(id) %>%
dplyr::mutate(scale = scale(value))
plotb <- ggplot(data = stage_b_cov_plot, aes(x=Year, y = scale, color = id, group = id)) +
geom_point( ) +
geom_line( ) +
scale_color_manual(guide = "none", values = PNWColors::pnw_palette(name="Sunset2",n=5)) +
facet_wrap(~id, scales = "free",ncol=1) +
theme_classic()  +
ylab(" ") +
ggtitle("Stage B Covariates - Scaled") +
geom_hline(yintercept = 0, linetype =2)
plotb
pdf("output/plot_Scaled_covariates_b.pdf",  width = 7, height = 12)
plotb
dev.off()
ggplot( ) +
geom_point(data = stage_a_cov, aes(x=Year, y = kusko_mean_discharge), color = "#625a94") +
geom_line(data = stage_a_cov, aes(x=Year, y = kusko_mean_discharge), color = "#625a94") +
geom_point(data = stage_a_cov, aes(x=Year, y = yukon_mean_discharge), color = "#f9ad2a") +
geom_line(data = stage_a_cov, aes(x=Year, y = yukon_mean_discharge), color = "#f9ad2a") +
scale_color_manual(guide = "none", values =  ) +
facet_wrap(~id, scales = "free",ncol=1) +
theme_classic()  +
ggtitle("Stage A Covariates")
ggplot( ) +
geom_point(data = stage_a_cov, aes(x=Year, y = kusko_mean_discharge), color = "#625a94") +
geom_line(data = stage_a_cov, aes(x=Year, y = kusko_mean_discharge), color = "#625a94") +
geom_point(data = stage_a_cov, aes(x=Year, y = yukon_mean_discharge), color = "#f9ad2a") +
geom_line(data = stage_a_cov, aes(x=Year, y = yukon_mean_discharge), color = "#f9ad2a") +
scale_color_manual(guide = "none", values =  ) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge")
discharge <- stage_a_cov %>%
select(Year, kusko_mean_discharge,yukon_mean_discharge) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(Year) %>%
mutate(scale = scale(value))
ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(values = PNWColors::pnw_palette(name="Sunset2",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge")
discharge <- stage_a_cov %>%
select(Year, kusko_mean_discharge,yukon_mean_discharge) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(Year) %>%
mutate(scale = scale(value))
View(discharge)
discharge <- stage_a_cov %>%
select(Year, kusko_mean_discharge,yukon_mean_discharge) %>%
gather(2:3, key = "id", value = "value")
discharge <- stage_a_cov %>%
select(Year, kusko_mean_discharge,yukon_mean_discharge) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(values = PNWColors::pnw_palette(name="Sunset2",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge")
ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0)
ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0)
ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0) +
ylab(" ")
rivera <- ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0) +
ylab(" ")
pdf("output/plot_Cov_Riverdischarge_A.pdf",  width = 7, height = 7)
rivera
dev.off()
pdf("output/plot_Cov_Riverdischarge_A.pdf",  width = 10, height = 7)
rivera
dev.off()
pdf("output/plot_Cov_Riverdischarge_A.pdf",  width = 7, height = 4)
rivera
dev.off()
rivera <- ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
pdf("output/plot_Cov_Riverdischarge_A.pdf",  width = 7, height = 4)
rivera
dev.off()
airtemp <- stage_a_cov %>%
select(Year, kusko_aniak_mean_airtemp,yukon_chena_mean_airtemp) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
airtempa <- ggplot( data = airtemp, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean River Discharge") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
airtempa
airtempa <- ggplot( data = airtemp, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean Air Temp") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
pdf("output/plot_Cov_AirTemp_A.pdf",  width = 7, height = 4)
airtemp
dev.off()
airtemp <- stage_a_cov %>%
select(Year, kusko_aniak_mean_airtemp,yukon_chena_mean_airtemp) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
View(airtemp)
airtempa <- ggplot( data = airtemp, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Mean Air Temp") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
airtempa
pdf("output/plot_Cov_AirTemp_A.pdf",  width = 7, height = 4)
airtempa
dev.off()
SST_NBS <- stage_a_cov %>%
select(Year, SST_CDD_NBS) %>%
mutate(scale = scale(SST_CDD_NBS))
SST_NBS <- stage_a_cov %>%
select(Year, SST_CDD_NBS) %>%
mutate(scale = scale(SST_CDD_NBS))
SST_NBSa <- ggplot( data = SST_NBS, aes(x=Year, y = scale), color = "#4682B4") +
geom_point(  ) +
geom_line( ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- NBS SST (cummulative degree days)") +
geom_hline(yintercept =0) +
ylab(" ") #+
#theme(legend.position = "bottom")
pdf("output/plot_SST_NBSCDD_A.pdf",  width = 7, height = 4)
SST_NBSa
dev.off()
SST_NBSa
SST_NBSa <- ggplot( data = SST_NBS, aes(x=Year, y = scale), color = "#4682B4") +
geom_point(  ) +
geom_line( ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- NBS SST (cummulative degree days)") +
geom_hline(yintercept =0) +
ylab(" ") #+
SST_NBSa
SST_NBSa <- ggplot( data = SST_NBS, aes(x=Year, y = scale), color = "#4682B4") +
geom_point( color = "#4682B4" ) +
geom_line( color = "#4682B4" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- NBS SST (cummulative degree days)") +
geom_hline(yintercept =0) +
ylab(" ") #+
SST_NBSa
pdf("output/plot_SST_NBSCDD_A.pdf",  width = 7, height = 4)
SST_NBSa
dev.off()
large_zoop <- stage_a_cov %>%
select(Year, large_zoop_NBS) %>%
mutate(scale = scale(large_zoop_NBS))
large_zoopa <- ggplot( data = large_zoop, aes(x=Year, y = scale) ) +
geom_point( color = "#FFDB58" ) +
geom_line( color = "#FFDB58" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Large zooplankton NBS") +
geom_hline(yintercept =0) +
ylab(" ")
large_zoopa
large_zoopa <- ggplot( data = large_zoop, aes(x=Year, y = scale) ) +
geom_point( color = "#e1ad01" ) +
geom_line( color = "#e1ad01" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Large zooplankton NBS") +
geom_hline(yintercept =0) +
ylab(" ")
large_zoopa
source("~/Documents/GitHub/AYK_prey/scripts/Make_Plot_all_covariates.R", echo=TRUE)
large_zoop <- stage_a_cov %>%
select(Year, large_zoop_NBS) %>%
mutate(scale = scale(large_zoop_NBS))
large_zoopa <- ggplot( data = large_zoop, aes(x=Year, y = scale) ) +
geom_point( color = "#e1ad01" ) +
geom_line( color = "#e1ad01" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Large zooplankton NBS") +
geom_hline(yintercept =0) +
ylab(" ")
pdf("output/plot_largezoop_A.pdf",  width = 7, height = 4)
large_zoopa
dev.off()
gelatinous_zoop <- stage_a_cov %>%
select(Year, gelatinous_zoop_NBS) %>%
mutate(scale = scale(gelatinous_zoop_NBS))
gelatinous_zoopa <- ggplot( data = gelatinous_zoop, aes(x=Year, y = scale) ) +
geom_point( color = "#301934" ) +
geom_line( color = "#301934" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Gelatinous zooplankton NBS") +
geom_hline(yintercept =0) +
ylab(" ")
gelatinous_zoopa
pdf("output/plot_gelatinouszoop_A.pdf",  width = 7, height = 4)
gelatinous_zoopa
dev.off()
gelatinous_zoop <- stage_a_cov %>%
select(Year, gelatinous_zoop_NBS) %>%
mutate(scale = scale(gelatinous_zoop_NBS))
gelatinous_zoopa <- ggplot( data = gelatinous_zoop, aes(x=Year, y = scale) ) +
geom_point( color = "#301934" ) +
geom_line( color = "#301934" ) +
# scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage A- Gelatinous zooplankton NBS") +
geom_hline(yintercept =0) +
ylab(" ")
pdf("output/plot_gelatinouszoop_A.pdf",  width = 7, height = 4)
gelatinous_zoopa
dev.off()
SST_SEBS <- stage_b_cov %>%
select(Year, SST_CDD_SEBS)
SST_SEBS <- stage_b_cov %>%
select(Year, SST_CDD_SEBS)
SST_SEBS <- stage_b_cov %>%
select(Year, SST_CDD_SEBS)  %>%
mutate(scale = scale(value))
sstb <- ggplot( data = SST_SEBS, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B- SST SEBS (CDD January-June)") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
SST_SEBS <- stage_b_cov %>%
select(Year, SST_CDD_SEBS)  %>%
mutate(scale = scale(SST_CDD_SEBS))
sstb <- ggplot( data = SST_SEBS, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B- SST SEBS (CDD January-June)") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
pdf("output/plot_SST_CDD_SEBS_B.pdf",  width = 7, height = 4)
sstb
dev.off()
sstb <- ggplot( data = SST_SEBS, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B- SST SEBS (CDD January-June)") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
pdf("output/plot_SST_CDD_SEBS_B.pdf",  width = 7, height = 4)
sstb
dev.off()
sstb <- ggplot( data = SST_SEBS, aes(x=Year, y = scale )) +
geom_point(color = "#4B5320"  ) +
geom_line(color = "#4B5320" ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B- SST SEBS (CDD January-June)") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
sstb
pdf("output/plot_SST_CDD_SEBS_B.pdf",  width = 7, height = 4)
sstb
dev.off()
## discharge =============
# c("SST_CDD_SEBS",
#   "Chum_hatchery",
#   "Pink_hatchery",
#   "kusko_mean_discharge_summer",
#   "yukon_mean_discharge_summer" )))
discharge <- stage_b_cov %>%
select(Year, kusko_mean_discharge,yukon_mean_discharge) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
## discharge =============
# c("SST_CDD_SEBS",
#   "Chum_hatchery",
#   "Pink_hatchery",
#   "kusko_mean_discharge_summer",
#   "yukon_mean_discharge_summer" )))
discharge <- stage_b_cov %>%
select(Year, kusko_mean_discharge_summer,yukon_mean_discharge_summer) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
riverb <- ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B - Mean River Discharge") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
riverb <- ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B - Mean River Discharge, Summer") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
riverb <- ggplot( data = discharge, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Bay",n=2)) +
theme_classic()  +
ggtitle("Stage B - Mean River Discharge, Summer") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
pdf("output/plot_Cov_Riverdischarge_B.pdf",  width = 7, height = 4)
riverb
dev.off()
## hatchery =============
# c("SST_CDD_SEBS",
#   "Chum_hatchery",
#   "Pink_hatchery",
#   "kusko_mean_discharge_summer",
#   "yukon_mean_discharge_summer" )))
hatchery <- stage_b_cov %>%
select(Year, Pink_hatchery,Chum_hatchery) %>%
gather(2:3, key = "id", value = "value") %>%
group_by(id) %>%
mutate(scale = scale(value))
hatcheryb <- ggplot( data = hatchery, aes(x=Year, y = scale, group = id, color =id)) +
geom_point(  ) +
geom_line( ) +
scale_color_manual(name = " ", values = PNWColors::pnw_palette(name="Sunset2",n=2)) +
theme_classic()  +
ggtitle("Stage B - Hatchery releases") +
geom_hline(yintercept =0) +
ylab(" ") +
theme(legend.position = "bottom")
hatcheryb
pdf("output/plot_Cov_hatchery_B.pdf",  width = 7, height = 4)
hatcheryb
dev.off()
library(GGally)
library(here)
library(tidyverse)
# load covariates ==========
cov_a <- read.csv("data/processed_covariates/stage_a_all.csv")
cov_b <- read.csv("data/processed_covariates/stage_b_all.csv")
# Test for b =========
X_b<-cov_b[,2:5]
View(X_b)
colinearity_b <-ggpairs(X)
# Test for A =========
X_a<-cov_a[,2:8]
colinearity_a <-ggpairs(X_a)
pdf("output/cova_a_plot.pdf")
print(colinearity_a)
dev.off()
# Test for b =========
X_b<-cov_b[,2:5]
colinearity_b <-ggpairs(X_b)
pdf("output/cova_b_plot.pdf")
print(colinearity_b)
dev.off()
colinearity_b
pdf("output/cov_b_plot.pdf")
print(colinearity_b)
dev.off()
View(cov_a)
View(cov_a)
cov_a <- read.csv("data/processed_covariates/stage_a_all.csv") %>%
gather(2:8, key = "key", value = "value") %>%
group_by(key) %>%
mutate(value = scale(value))
View(cov_a)
# load covariates ==========
cov_a <- read.csv("data/processed_covariates/stage_a_all.csv") %>%
gather(2:8, key = "key", value = "value") %>%
group_by(key) %>%
mutate(value = scale(value)) %>%
spread(key, value)
View(cov_a)
cov_b <- read.csv("data/processed_covariates/stage_b_all.csv") %>%
gather(2:5, key = "key", value = "value") %>%
group_by(key) %>%
mutate(value = scale(value)) %>%
spread(key, value)
View(cov_b)
# Test for A =========
X_a<-cov_a[,2:8]
colinearity_a <-ggpairs(X_a)
pdf("output/cova_a_plot.pdf")
print(colinearity_a)
dev.off()
colinearity_a
# Test for b =========
X_b<-cov_b[,2:5]
colinearity_b <-ggpairs(X_b)
pdf("output/cov_b_plot.pdf")
print(colinearity_b)
dev.off()
View(X_b)
View(cov_b)
cov_b <- read.csv("data/processed_covariates/stage_b_all.csv")
View(cov_b)
cov_b <- read.csv("data/processed_covariates/stage_b_all.csv") %>%
gather(2:6, key = "key", value = "value") %>%
group_by(key) %>%
mutate(value = scale(value)) %>%
spread(key, value)
# Test for b =========
X_b<-cov_b[,2:6]
colinearity_b <-ggpairs(X_b)
pdf("output/cov_b_plot.pdf")
print(colinearity_b)
dev.off()
View(cov_a)
