Calanus_EMA_60BON_505 <- filter(Calanus_EMA_60BON, MESH==505)
Calanus_EMA_60BON_505 <- filter(Calanus_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)")
Calanus_EMA_20BON <- filter(Calanus_EMA, GEAR_NAME=="20BON")
Calanus_EMA_20BON_153 <- filter(Calanus_EMA_20BON, MESH==153)
Calanus_EMA_20BON_153 <- filter(Calanus_EMA_20BON_153, STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 1 (COPEPODITE I)")
#The other gears are correct, so rebuild dataset
Calanus_EMA_Final <- rbind(Calanus_EMA_60BON_333, Calanus_EMA_60BON_505, Calanus_EMA_20BON_153)
ungroup(Calanus_EMA_Final)
#Remove some files
rm(Calanus_EMA_byGEAR_NAME, Calanus_EMA_20BON, Calanus_EMA_20BON_153, Calanus_EMA_60BON, Calanus_EMA_60BON_333, Calanus_EMA_60BON_505)
#Combine into final, Calanus data set
Calanus <- rbind(Calanus_EMA_Final, Calanus_EcoDAAT_Final)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Calanus)
Calanus_pacificus <- filter(NBS_Zoop_Process, TAXA_COARSE == "Calanus pacificus")
#Separate EMA data as they were sorted under different protocols
Calanus_pacificus_EMA <- filter(Calanus_pacificus, DATA_SOURCE=="EMA")
Calanus_pacificus_EcoDAAT <- filter(Calanus_pacificus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Calanus_pacificus_EcoDAAT_bySPECIMEN_FORM <- group_by(Calanus_pacificus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Calanus_pacificus_EcoDAAT_FormSummary <- summarise(Calanus_pacificus_EcoDAAT_bySPECIMEN_FORM,n())
#Stages and gear are correct for EcoDAAT data
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Calanus_pacificus_EMA_byGEAR_NAME <- group_by(Calanus_pacificus_EMA, MESH, GEAR_NAME)
Calanus_pacificus_EMA_GearSummary <- summarise(Calanus_pacificus_EMA_byGEAR_NAME, n())
# Need to filter for the correct stages for avoid double counts, just remove one Juday sample
Calanus_pacificus_EMA <- filter(Calanus_pacificus_EMA, GEAR_NAME!="Juday")
#Combine into final, Calanus_pacificus data set
Calanus_pacificus <- rbind(Calanus_pacificus_EMA, Calanus_pacificus_EcoDAAT)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Calanus_pacificus)
Caridea <- filter(NBS_Zoop_Process, TAXA_COARSE == "Caridea")
#Caridea estimate from larger nets only
Caridea <- filter(Caridea, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Caridea)
Centropages <- filter(NBS_Zoop_Process, TAXA_COARSE=="Centropages abdominalis")
#Separate EMA data as they were sorted under different protocols
Centropages_EMA <- filter(Centropages, DATA_SOURCE=="EMA")
Centropages_EcoDAAT <- filter(Centropages, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Centropages_EcoDAAT_bySPECIMEN_FORM <- group_by(Centropages_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Centropages_EcoDAAT_FormSummary <- summarise(Centropages_EcoDAAT_bySPECIMEN_FORM,n())
#Filter for correct GEAR_NAME and MESH from EcoDAAT
Centropages_EcoDAAT <- filter(Centropages_EcoDAAT, SPECIMEN_FORM!="G")
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Centropages_EMA_byGEAR_NAME <- group_by(Centropages_EMA, MESH, GEAR_NAME)
Centropages_EMA_GearSummary <- summarise(Centropages_EMA_byGEAR_NAME, n())
#For consistency, select the smaller gear only
Centropages_EMA <- filter(Centropages_EMA, GEAR_NAME!="60BON")
#Recombined data
Centropages <- rbind(Centropages_EcoDAAT, Centropages_EMA)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Centropages)
Chaetognatha <- filter(NBS_Zoop_Process, TAXA_COARSE=="Chaetognatha")
#Filter for Chaetognatha from the 60BON nets only
Chaetognatha <- filter(Chaetognatha, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Chaetognatha)
Cirripedia <- filter(NBS_Zoop_Process, TAXA_COARSE == "Cirripedia")
#Can filter for both gears and then add a taxa coarse of Cirripedia_large and Cirripedia_small
Cirripedia_large <- filter(Cirripedia, GEAR_NAME=="60BON")
#Recode coarse taxa
Cirripedia_large$TAXA_COARSE[Cirripedia_large$TAXA_COARSE=="Cirripedia"] <- "Cirripedia_large"
Cirripedia_small <- filter(Cirripedia, GEAR_NAME!="60BON")
#Recode coarse taxa
Cirripedia_small$TAXA_COARSE[Cirripedia_small$TAXA_COARSE=="Cirripedia"] <- "Cirripedia_small"
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Cirripedia_large, Cirripedia_small)
Cladocera <- filter(NBS_Zoop_Process, TAXA_COARSE=="Cladocera")
#Cladocera fromt he small net only
#Filter for correct gear
Cladocera <- filter(Cladocera, GEAR_NAME!= "60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Cladocera)
Clione <- filter(NBS_Zoop_Process, TAXA_COARSE=="Clione limacina")
#Estimate from the larger net only
Clione <- filter(Clione, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Clione)
Cnidaria <- filter(NBS_Zoop_Process, TAXA_COARSE == "Cnidaria")
#Can filter for both gears and then add a taxa coarse of Cnidaria_large and Cnidaria_small
Cnidaria_large <- filter(Cnidaria, GEAR_NAME=="60BON")
#Recode coarse taxa
Cnidaria_large$TAXA_COARSE[Cnidaria_large$TAXA_COARSE=="Cnidaria"] <- "Cnidaria_large"
Cnidaria_small <- filter(Cnidaria, GEAR_NAME!="60BON")
#Recode coarse taxa
Cnidaria_small$TAXA_COARSE[Cnidaria_small$TAXA_COARSE=="Cnidaria"] <- "Cnidaria_small"
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Cnidaria_large, Cnidaria_small)
Copepod_small <- filter(NBS_Zoop_Process, TAXA_COARSE == "Copepod_small")
#Filter for the smaller mesh gears only
Copepod_small <- filter(Copepod_small, GEAR_NAME!="60BON")
#Now build the large dataset
Copepod_large <- filter(NBS_Zoop_Process, TAXA_COARSE == "Copepod_large")
#Filter for the smaller mesh gears only
Copepod_large <- filter(Copepod_large, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Copepod_large, Copepod_small)
Ctenophora <- filter(NBS_Zoop_Process, TAXA_COARSE=="Ctenophora")
#Filter for the large net only
Ctenophora <- filter(Ctenophora, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Ctenophora)
Cumacea <- filter(NBS_Zoop_Process, TAXA_COARSE=="Cumacea")
#Filter for the large net only
Cumacea <- filter(Cumacea, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Cumacea)
Decapoda <- filter(NBS_Zoop_Process, TAXA_COARSE=="Decapoda")
#Very few measurements of unidentfied decapods. We can ignore
Echinodermata <- filter(NBS_Zoop_Process, TAXA_COARSE=="Echinodermata")
#Echinodermata are tiny, filter from small nets only
Echinodermata <- filter(Echinodermata, GEAR_NAME!="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Echinodermata)
Epilabidocera <- filter(NBS_Zoop_Process, TAXA_COARSE=="Epilabidocera longipedata")
#Separate EMA data as they were sorted under different protocols
Epilabidocera_EMA <- filter(Epilabidocera, DATA_SOURCE=="EMA")
Epilabidocera_EcoDAAT <- filter(Epilabidocera, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Epilabidocera_EcoDAAT_bySPECIMEN_FORM <- group_by(Epilabidocera_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Epilabidocera_EcoDAAT_FormSummary <- summarise(Epilabidocera_EcoDAAT_bySPECIMEN_FORM,n())
#Things are correct for the EcoDAAT data, not look at the EMA data
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Epilabidocera_EMA_byGEAR_NAME <- group_by(Epilabidocera_EMA, MESH, GEAR_NAME)
Epilabidocera_EMA_GearSummary <- summarise(Epilabidocera_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Epilabidocera_EMA_60BON <- filter(Epilabidocera_EMA, GEAR_NAME=="60BON")
Epilabidocera_EMA_60BON_333 <- filter(Epilabidocera_EMA_60BON, MESH==333)
Epilabidocera_EMA_60BON_333 <- filter(Epilabidocera_EMA_60BON_333, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
Epilabidocera_EMA_60BON_505 <- filter(Epilabidocera_EMA_60BON, MESH==505)
Epilabidocera_EMA_60BON_505 <- filter(Epilabidocera_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)")
Epilabidocera_EMA_20BON <- filter(Epilabidocera_EMA, GEAR_NAME=="20BON")
Epilabidocera_EMA_20BON_153 <- filter(Epilabidocera_EMA_20BON, MESH==153)
Epilabidocera_EMA_20BON_153 <- filter(Epilabidocera_EMA_20BON_153, STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 1 (COPEPODITE I)")
#The other gears are correct, so rebuild dataset
Epilabidocera_EMA_Final <- rbind(Epilabidocera_EMA_60BON_333, Epilabidocera_EMA_60BON_505, Epilabidocera_EMA_20BON_153)
ungroup(Epilabidocera_EMA_Final)
#Remove some files
rm(Epilabidocera_EMA_byGEAR_NAME, Epilabidocera_EMA_20BON, Epilabidocera_EMA_20BON_153, Epilabidocera_EMA_60BON, Epilabidocera_EMA_60BON_333, Epilabidocera_EMA_60BON_505)
#Combine into final, Epilabidocera data set
Epilabidocera <- rbind(Epilabidocera_EMA_Final, Epilabidocera_EcoDAAT)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Epilabidocera)
Eucalanus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Eucalanus bungii")
#Separate EMA data as they were sorted under different protocols
Eucalanus_EMA <- filter(Eucalanus, DATA_SOURCE=="EMA")
Eucalanus_EcoDAAT <- filter(Eucalanus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Eucalanus_EcoDAAT_bySPECIMEN_FORM <- group_by(Eucalanus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Eucalanus_EcoDAAT_FormSummary <- summarise(Eucalanus_EcoDAAT_bySPECIMEN_FORM,n())
#Do some filtering to get the correct stages from the correct gear for EcoDAAT data
Eucalanus_EcoDAAT_A <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="A")
Eucalanus_EcoDAAT_A <- filter(Eucalanus_EcoDAAT_A, MESH!=153)
Eucalanus_EcoDAAT_B <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="B")
Eucalanus_EcoDAAT_B <- filter(Eucalanus_EcoDAAT_B, MESH!=153)
Eucalanus_EcoDAAT_C <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="C")
Eucalanus_EcoDAAT_C <- filter(Eucalanus_EcoDAAT_C, MESH==153)
Eucalanus_EcoDAAT_F <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="F")
Eucalanus_EcoDAAT_G <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="G")
Eucalanus_EcoDAAT_H <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="H")
Eucalanus_EcoDAAT_K <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="K")
Eucalanus_EcoDAAT_L <- filter(Eucalanus_EcoDAAT, SPECIMEN_FORM=="L")
#The other gears are correct, so rebuild dataset
Eucalanus_EcoDAAT_Final <- rbind(Eucalanus_EcoDAAT_A, Eucalanus_EcoDAAT_B, Eucalanus_EcoDAAT_C, Eucalanus_EcoDAAT_F,  Eucalanus_EcoDAAT_G, Eucalanus_EcoDAAT_H, Eucalanus_EcoDAAT_K, Eucalanus_EcoDAAT_L)
ungroup(Eucalanus_EcoDAAT_Final)
#Remove some files
rm(Eucalanus_EcoDAAT_bySPECIMEN_FORM, Eucalanus_EcoDAAT_A, Eucalanus_EcoDAAT_B, Eucalanus_EcoDAAT_C, Eucalanus_EcoDAAT_F, Eucalanus_EcoDAAT_G, Eucalanus_EcoDAAT_H, Eucalanus_EcoDAAT_K, Eucalanus_EcoDAAT_L)
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Eucalanus_EMA_byGEAR_NAME <- group_by(Eucalanus_EMA, MESH, GEAR_NAME)
Eucalanus_EMA_GearSummary <- summarise(Eucalanus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Eucalanus_EMA_60BON <- filter(Eucalanus_EMA, GEAR_NAME=="60BON")
Eucalanus_EMA_60BON_333 <- filter(Eucalanus_EMA_60BON, MESH==333)
Eucalanus_EMA_60BON_333 <- filter(Eucalanus_EMA_60BON_333, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
Eucalanus_EMA_60BON_505 <- filter(Eucalanus_EMA_60BON, MESH==505)
Eucalanus_EMA_60BON_505 <- filter(Eucalanus_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
Eucalanus_EMA_20BON <- filter(Eucalanus_EMA, GEAR_NAME=="20BON")
Eucalanus_EMA_20BON_153 <- filter(Eucalanus_EMA_20BON, MESH==153)
Eucalanus_EMA_20BON_153 <- filter(Eucalanus_EMA_20BON_153, STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 1 (COPEPODITE I)")
#The other gears are correct, so rebuild dataset
Eucalanus_EMA_Final <- rbind(Eucalanus_EMA_60BON_333, Eucalanus_EMA_60BON_505, Eucalanus_EMA_20BON_153)
ungroup(Eucalanus_EMA_Final)
#Remove some files
rm(Eucalanus_EMA_byGEAR_NAME, Eucalanus_EMA_20BON, Eucalanus_EMA_20BON_153, Eucalanus_EMA_60BON, Eucalanus_EMA_60BON_333, Eucalanus_EMA_60BON_505)
#Combine into final, Eucalanus data set
Eucalanus <- rbind(Eucalanus_EMA_Final, Eucalanus_EcoDAAT_Final)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Eucalanus)
E_pacifica <- filter(NBS_Zoop_Process, TAXA_COARSE=="Euphausia pacifica")
#Filter for large net only and stages are adult and juvenile
E_pacifica <- filter(E_pacifica, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, E_pacifica)
Euphausiacea <- filter(NBS_Zoop_Process, TAXA_COARSE=="Euphausiacea")
#First separate out the adults belonging to Tessarbranchion oculatum
Tessarabrachion_oculatum <- filter (Euphausiacea, TAXON_NAME=="Tessarabrachion oculatum")
#Now filter the Euphausiacea for the correct stages and nets
Euphausiacea <- filter(Euphausiacea, TAXON_NAME!="Tessarabrachion oculatum")
#Eliminate adult and juvenile stages, those should be identified to species
Euphausiacea <- filter(Euphausiacea, STAGE_NAME!= "A + J (ADULT/JUVENILE)")
Euphausiacea <- filter(Euphausiacea, STAGE_NAME!= "JUVENILE")
#Get rid of the NOT DETERMINED
Euphausiacea <- filter(Euphausiacea, STAGE_NAME!="NOT DETERMINED")
#Get rid of the EGG
Euphausiacea <- filter(Euphausiacea, STAGE_NAME!="EGG")
#Now create the furcilia dataset
Euphausiacea_furcilia <- filter(Euphausiacea, STAGE_NAME=="FURCILIA")
Euphausiacea_furcilia <- filter(Euphausiacea, GEAR_NAME=="60BON")
#Now create the calytopis dataset
Euphausiacea_calyptopis <- filter(Euphausiacea, STAGE_NAME=="CALYPTOPIS (STAGE NOT DETERMINED)"|STAGE_NAME=="CALYPTOPIS 1"|STAGE_NAME=="CALYPTOPIS 2"|STAGE_NAME=="CALYPTOPIS 3")
#Now create the nauplius dataset
Euphausiacea_nauplius <- filter(Euphausiacea, STAGE_NAME=="NAUPLIUS")
#Filter for small nets only
Euphausiacea_nauplius <- filter(Euphausiacea_nauplius, GEAR_NAME!="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Euphausiacea_furcilia, Euphausiacea_calyptopis, Euphausiacea_nauplius)
Eurytemora <- filter(NBS_Zoop_Process, TAXA_COARSE=="Eurytemora spp.")
#Filter from the small nets only
Eurytemora <- filter(Eurytemora, GEAR_NAME!="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Eurytemora)
Gastropoda <- filter(NBS_Zoop_Process, TAXA_COARSE=="Gastropoda")
#Unidentified gastropods, can remove from final dataset
Limacina <- filter(NBS_Zoop_Process, TAXA_COARSE=="Limacina helicina")
#Can split into estiamtes from large and small nets
Limacina_large <- filter(Limacina, GEAR_NAME=="60BON")
#Rename the coarse taxa
Limacina_large$TAXA_COARSE[Limacina_large$TAXA_COARSE=="Limacina helicina"] <- "Limacina_large"
#Now do the small nets
Limacina_small <- filter(Limacina, GEAR_NAME!="60BON")
#Rename the coarse taxa
Limacina_small$TAXA_COARSE[Limacina_small$TAXA_COARSE=="Limacina helicina"] <- "Limacina_small"
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Limacina_large, Limacina_small)
Metridia_longa <- filter(NBS_Zoop_Process, TAXA_COARSE=="Metridia longa")
#Adults, C5 only so all is good, can add to full data set
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Metridia_longa)
Metridia_okhotensis <- filter(NBS_Zoop_Process, TAXA_COARSE=="Metridia okhotensis")
#Adults, C4, and C5 only so all is good, can add to full data set
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Metridia_okhotensis)
Metridia_pacifica <- filter(NBS_Zoop_Process, TAXA_COARSE=="Metridia pacifica")
#Separate EMA data as they were sorted under different protocols
Metridia_pacifica_EMA <- filter(Metridia_pacifica, DATA_SOURCE=="EMA")
Metridia_pacifica_EcoDAAT <- filter(Metridia_pacifica, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Metridia_pacifica_EcoDAAT_bySPECIMEN_FORM <- group_by(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Metridia_pacifica_EcoDAAT_FormSummary <- summarise(Metridia_pacifica_EcoDAAT_bySPECIMEN_FORM,n())
#Do some filtering to get the correct stages from the correct gear for EcoDAAT data
Metridia_pacifica_EcoDAAT_B <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="B")
Metridia_pacifica_EcoDAAT_B <- filter(Metridia_pacifica_EcoDAAT_B, MESH!=153)
Metridia_pacifica_EcoDAAT_C <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="C")
Metridia_pacifica_EcoDAAT_G <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="G")
Metridia_pacifica_EcoDAAT_H <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="H")
#Remove C3 stage
Metridia_pacifica_EcoDAAT_H <- filter(Metridia_pacifica_EcoDAAT_H, STAGE_NAME!="C - 3 (COPEPODITE III)")
Metridia_pacifica_EcoDAAT_K <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="K")
Metridia_pacifica_EcoDAAT_L <- filter(Metridia_pacifica_EcoDAAT, SPECIMEN_FORM=="L")
#The other gears are correct, so rebuild dataset
Metridia_pacifica_EcoDAAT_Final <- rbind(Metridia_pacifica_EcoDAAT_B, Metridia_pacifica_EcoDAAT_C, Metridia_pacifica_EcoDAAT_G, Metridia_pacifica_EcoDAAT_H, Metridia_pacifica_EcoDAAT_K, Metridia_pacifica_EcoDAAT_L)
ungroup(Metridia_pacifica_EcoDAAT_Final)
#Remove some files
rm(Metridia_pacifica_EcoDAAT_bySPECIMEN_FORM, Metridia_pacifica_EcoDAAT_B, Metridia_pacifica_EcoDAAT_C, Metridia_pacifica_EcoDAAT_G, Metridia_pacifica_EcoDAAT_H, Metridia_pacifica_EcoDAAT_K, Metridia_pacifica_EcoDAAT_L)
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Metridia_pacifica_EMA_byGEAR_NAME <- group_by(Metridia_pacifica_EMA, MESH, GEAR_NAME)
Metridia_pacifica_EMA_GearSummary <- summarise(Metridia_pacifica_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Metridia_pacifica_EMA_60BON <- filter(Metridia_pacifica_EMA, GEAR_NAME=="60BON")
Metridia_pacifica_EMA_60BON_333 <- filter(Metridia_pacifica_EMA_60BON, MESH==333)
Metridia_pacifica_EMA_60BON_333 <- filter(Metridia_pacifica_EMA_60BON_333, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)")
Metridia_pacifica_EMA_60BON_505 <- filter(Metridia_pacifica_EMA_60BON, MESH==505)
Metridia_pacifica_EMA_60BON_505 <- filter(Metridia_pacifica_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)")
Metridia_pacifica_EMA_smallnets <- filter(Metridia_pacifica_EMA, GEAR_NAME!="60BON")
Metridia_pacifica_EMA_smallnets <- filter(Metridia_pacifica_EMA_smallnets, STAGE_NAME=="C - 1 (COPEPODITE I)"|STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
#Rename Metridia pacific of early stages as Metridia spp.
Metridia_pacifica_EMA_smallnets$TAXA_COARSE[Metridia_pacifica_EMA_smallnets$TAXA_COARSE=="Metridia pacifica"] <- "Metridia spp."
#The other gears are correct, so rebuild dataset
Metridia_pacifica_EMA_Final <- rbind(Metridia_pacifica_EMA_60BON_333, Metridia_pacifica_EMA_60BON_505, Metridia_pacifica_EMA_smallnets)
ungroup(Metridia_pacifica_EMA_Final)
#Remove some files
rm(Metridia_pacifica_EMA_byGEAR_NAME, Metridia_pacifica_EMA_smallnets, Metridia_pacifica_EMA_60BON, Metridia_pacifica_EMA_60BON_333, Metridia_pacifica_EMA_60BON_505)
#Combine into final, Metridia_pacifica data set
Metridia_pacifica <- rbind(Metridia_pacifica_EMA_Final, Metridia_pacifica_EcoDAAT_Final)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Metridia_pacifica)
Metridia_spp <- filter(NBS_Zoop_Process, TAXA_COARSE=="Metridia spp.")
#Filter for the small nets only
Metridia_spp <- filter(Metridia_spp, GEAR_NAME!="60BON")
#Now filter out the stages that are accurate for the small nets, anything less than stage C-3
Metridia_spp <- filter(Metridia_spp, STAGE_NAME!= "C-1 TO C-5")
Metridia_spp <- filter(Metridia_spp, STAGE_NAME!= "C3-4")
Metridia_spp <- filter(Metridia_spp, STAGE_NAME!= "C3-5")
Metridia_spp <- filter(Metridia_spp, STAGE_NAME!= "C - 4 (COPEPODITE IV)")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Metridia_spp)
Mysidae <- filter(NBS_Zoop_Process, TAXA_COARSE=="Mysidae")
#Filter for 60BON nets only
Mysidae <- filter(Mysidae, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Mysidae)
Cristatus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Neocalanus cristatus")
#Separate EMA data as they were sorted under different protocols
Cristatus_EMA <- filter(Cristatus, DATA_SOURCE=="EMA")
Cristatus_EcoDAAT <- filter(Cristatus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Cristatus_EcoDAAT_bySPECIMEN_FORM <- group_by(Cristatus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Cristatus_EcoDAAT_FormSummary <- summarise(Cristatus_EcoDAAT_bySPECIMEN_FORM,n())
#Do some filtering to get the correct stages from the correct gear for EcoDAAT data
Cristatus_EcoDAAT_A <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="A")
Cristatus_EcoDAAT_A <- filter(Cristatus_EcoDAAT_A, MESH!=153)
Cristatus_EcoDAAT_B <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="B")
Cristatus_EcoDAAT_B <- filter(Cristatus_EcoDAAT_B, MESH!=153)
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="C")
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT_C, MESH==153)
Cristatus_EcoDAAT_C <- filter(Cristatus_EcoDAAT_C, GEAR_NAME=="20BON")
Cristatus_EcoDAAT_F <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="F")
Cristatus_EcoDAAT_G <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="G")
Cristatus_EcoDAAT_H <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="H")
Cristatus_EcoDAAT_K <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="K")
Cristatus_EcoDAAT_L <- filter(Cristatus_EcoDAAT, SPECIMEN_FORM=="L")
#The other gears are correct, so rebuild dataset
Cristatus_EcoDAAT_Final <- rbind(Cristatus_EcoDAAT_A, Cristatus_EcoDAAT_B, Cristatus_EcoDAAT_C, Cristatus_EcoDAAT_F, Cristatus_EcoDAAT_G, Cristatus_EcoDAAT_H, Cristatus_EcoDAAT_K, Cristatus_EcoDAAT_L)
ungroup(Cristatus_EcoDAAT_Final)
#Remove some files
rm(Cristatus_EcoDAAT_bySPECIMEN_FORM, Cristatus_EcoDAAT_A, Cristatus_EcoDAAT_B, Cristatus_EcoDAAT_C, Cristatus_EcoDAAT_F, Cristatus_EcoDAAT_G, Cristatus_EcoDAAT_H, Cristatus_EcoDAAT_K, Cristatus_EcoDAAT_L)
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Cristatus_EMA_byGEAR_NAME <- group_by(Cristatus_EMA, MESH, GEAR_NAME)
Cristatus_EMA_GearSummary <- summarise(Cristatus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Cristatus_EMA_Final <-  filter(Cristatus_EMA, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
ungroup(Cristatus_EMA_Final)
#Now combine EMA and EcoDAAT data together
Cristatus_Final <- rbind(Cristatus_EMA_Final, Cristatus_EcoDAAT_Final)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Cristatus_Final)
Neocalanus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Neocalanus spp.")
#Separate EMA data as they were sorted under different protocols
Neocalanus_EMA <- filter(Neocalanus, DATA_SOURCE=="EMA")
Neocalanus_EcoDAAT <- filter(Neocalanus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Neocalanus_EcoDAAT_bySPECIMEN_FORM <- group_by(Neocalanus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Neocalanus_EcoDAAT_FormSummary <- summarise(Neocalanus_EcoDAAT_bySPECIMEN_FORM,n())
#Do some filtering to get the correct stages from the correct gear for EcoDAAT data
Neocalanus_EcoDAAT_B <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="B")
Neocalanus_EcoDAAT_B <- filter(Neocalanus_EcoDAAT_B, MESH!=153)
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="C")
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT_C, MESH==153)
Neocalanus_EcoDAAT_C <- filter(Neocalanus_EcoDAAT_C, GEAR_NAME=="20BON")
Neocalanus_EcoDAAT_G <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="G")
Neocalanus_EcoDAAT_H <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="H")
Neocalanus_EcoDAAT_K <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="K")
Neocalanus_EcoDAAT_L <- filter(Neocalanus_EcoDAAT, SPECIMEN_FORM=="L")
#The other gears are correct, so rebuild dataset
Neocalanus_EcoDAAT_Final <- rbind(Neocalanus_EcoDAAT_B, Neocalanus_EcoDAAT_C, Neocalanus_EcoDAAT_G, Neocalanus_EcoDAAT_H, Neocalanus_EcoDAAT_K, Neocalanus_EcoDAAT_L)
ungroup(Neocalanus_EcoDAAT_Final)
#Remove some files
rm(Neocalanus_EcoDAAT_bySPECIMEN_FORM, Neocalanus_EcoDAAT_B, Neocalanus_EcoDAAT_C, Neocalanus_EcoDAAT_G, Neocalanus_EcoDAAT_H, Neocalanus_EcoDAAT_K, Neocalanus_EcoDAAT_L)
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Neocalanus_EMA_byGEAR_NAME <- group_by(Neocalanus_EMA, MESH, GEAR_NAME)
Neocalanus_EMA_GearSummary <- summarise(Neocalanus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Neocalanus_EMA_Final <-  filter(Neocalanus_EMA, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)"|STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)")
ungroup(Neocalanus_EMA_Final)
#NOw combine EMA and EcoDAAT data together
Neocalanus_Final <- rbind(Neocalanus_EMA_Final, Neocalanus_EcoDAAT_Final)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Neocalanus_Final)
Oithona <- filter(NBS_Zoop_Process, TAXA_COARSE=="Oithona spp.")
#Filter for small nets only
Oithona <- filter(Oithona, GEAR_NAME!="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Oithona)
Ostracoda <- filter(NBS_Zoop_Process, TAXA_COARSE=="Ostracoda")
Polychaeta <- filter(NBS_Zoop_Process, TAXA_COARSE=="Polychaeta")
#Split into small and large estimates from the correct nets and meshes
Polychaeta_large <- filter(Polychaeta, GEAR_NAME=="60BON")
#Rename Polychaeta large
Polychaeta_large$TAXA_COARSE[Polychaeta_large$TAXA_COARSE=="Polychaeta"] <- "Polychaeta_large"
#Now do the small nets
Polychaeta_small <- filter(Polychaeta, GEAR_NAME!="60BON")
#Rename Polychaeta small
Polychaeta_small$TAXA_COARSE[Polychaeta_small$TAXA_COARSE=="Polychaeta"] <- "Polychaeta_small"
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Polychaeta_large, Polychaeta_small)
Pseudocalanus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Pseudocalanus spp.")
#Filter for the small nets only
Pseudocalanus <- filter(Pseudocalanus, GEAR_NAME!="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Pseudocalanus)
Thaliacea <- filter(NBS_Zoop_Process, TAXA_COARSE=="Thaliacea")
Themisto_abyssorum <- filter(NBS_Zoop_Process, TAXA_COARSE=="Themisto abyssorum")
Themisto_libellula <- filter(NBS_Zoop_Process, TAXA_COARSE=="Themisto libellula")
#Filter for the 60BON nets only
Themisto_libellula <- filter(Themisto_libellula, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Themisto_libellula)
Themisto_pacifica <- filter(NBS_Zoop_Process, TAXA_COARSE=="Themisto pacifica")
#Filter for the 60BON nets only
Themisto_pacifica <- filter(Themisto_pacifica, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Themisto_pacifica)
Themisto <- filter(NBS_Zoop_Process, TAXA_COARSE=="Themisto spp.")
#Filter for the 60BON nets only
Themisto<- filter(Themisto, GEAR_NAME=="60BON")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Themisto)
Thysanoessa <- filter(NBS_Zoop_Process, TAXA_COARSE=="Thysanoessa inermis"|TAXA_COARSE=="Thysanoessa inspinata"|TAXA_COARSE=="Thysanoessa longipes"|TAXA_COARSE=="Thysanoessa raschii"|TAXA_COARSE=="Thysanoessa spinifera")
#Select for 60BON only
Thysanoessa <- filter(Thysanoessa, GEAR_NAME=="60BON")
#Now the correct stages
Thysanoessa <- filter(Thysanoessa, STAGE_NAME=="A + J (ADULT/JUVENILE)"|STAGE_NAME=="JUVENILE"|STAGE_NAME=="ADULT")
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Thysanoessa)
Tortanus <- filter(NBS_Zoop_Process, TAXA_COARSE=="Tortanus discaudatus")
#Separate EMA data as they were sorted under different protocols
Tortanus_EMA <- filter(Tortanus, DATA_SOURCE=="EMA")
Tortanus_EcoDAAT <- filter(Tortanus, DATA_SOURCE=="EcoDAAT")
#Check to see if right stages are in the EcoDAAT data
Tortanus_EcoDAAT_bySPECIMEN_FORM <- group_by(Tortanus_EcoDAAT, SPECIMEN_FORM, MESH, GEAR_NAME)
Tortanus_EcoDAAT_FormSummary <- summarise(Tortanus_EcoDAAT_bySPECIMEN_FORM,n())
#EcoDAAT data are correctly specified
#Now filter the EMA data to match the EcoDAAT data. EMA tends to double count variables from both nets, so eliminate this
#Check to see if what stages are where with EMA data
Tortanus_EMA_byGEAR_NAME <- group_by(Tortanus_EMA, MESH, GEAR_NAME)
Tortanus_EMA_GearSummary <- summarise(Tortanus_EMA_byGEAR_NAME, n())
#No issues with mismatched mesh and gear sizes. Need to filter for the correct stages for avoid double counts
Tortanus_EMA_60BON <- filter(Tortanus_EMA, GEAR_NAME=="60BON")
Tortanus_EMA_60BON_333 <- filter(Tortanus_EMA_60BON, MESH==333)
Tortanus_EMA_60BON_333 <- filter(Tortanus_EMA_60BON_333, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)")
Tortanus_EMA_60BON_505 <- filter(Tortanus_EMA_60BON, MESH==505)
Tortanus_EMA_60BON_505 <- filter(Tortanus_EMA_60BON_505, STAGE_NAME=="ADULT"|STAGE_NAME=="C - 5 (COPEPODITE V)")
Tortanus_EMA_smallnets <- filter(Tortanus_EMA, GEAR_NAME!="60BON")
Tortanus_EMA_smallnets <- filter(Tortanus_EMA_smallnets, STAGE_NAME=="C - 4 (COPEPODITE IV)"|STAGE_NAME=="C - 3 (COPEPODITE III)"|STAGE_NAME=="C - 2 (COPEPODITE II)"|STAGE_NAME=="C - 1 (COPEPODITE I)")
#The other gears are correct, so rebuild dataset
Tortanus_EMA_Final <- rbind(Tortanus_EMA_60BON_333, Tortanus_EMA_60BON_505, Tortanus_EMA_smallnets)
ungroup(Tortanus_EMA_Final)
#Remove some files
rm(Tortanus_EMA_byGEAR_NAME,  Tortanus_EMA_smallnets, Tortanus_EMA_60BON, Tortanus_EMA_60BON_333, Tortanus_EMA_60BON_505)
#Combine into final, Tortanus data set
Tortanus <- rbind(Tortanus_EMA_Final, Tortanus_EcoDAAT)
#Add to final dataset
NBS_Zoop_Process_Final <- rbind (NBS_Zoop_Process_Final, Tortanus)
#NOw read in the biomass conversion data set
Biomass_annotated <- read_xlsx(here("data", "Biomass", "Biomass-Annotated.xlsx"))
#Merge the two data sets based on TAXA_COARSE, STAGE_NAME, SEX_NAME
NBS_Zoop_Process_Final <- left_join(NBS_Zoop_Process_Final, Biomass_annotated, by = c("TAXA_COARSE", "STAGE_NAME", "SEX_NAME"))
#Do some tidying to eliminate some columns
NBS_Zoop_Process_Final$NOTE <- NULL
NBS_Zoop_Process_Final$IND_WW_MG_NOTE <- NULL
NBS_Zoop_Process_Final$IND_DW_MG_CONVERTED_NOTE <- NULL
NBS_Zoop_Process_Final$IND_C_MG_CONVERTED_NOTE <- NULL
NBS_Zoop_Process_Final$GROWTH_RATE_NOTE <- NULL
#Create wet weight biomass column converted individual wet weight and abundance
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_WW_MG_M3_MEAN = IND_WW_MG_MEASURED_MEAN*EST_NUM_PERM3)
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_WW_MG_M3_SD = IND_WW_MG_MEASURED_SD*EST_NUM_PERM3)
#Create dry weight biomass column converted individual dry weight and abundance
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_DW_MG_M3_MEAN = IND_DW_MG_CONVERTED_MEAN*EST_NUM_PERM3)
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_DW_MG_M3_SD = IND_DW_MG_CONVERTED_SD*EST_NUM_PERM3)
#Create carbon weight biomass column converted individual carbon weight and abundance
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_C_MG_M3_MEAN = IND_C_MG_CONVERTED_MEAN*EST_NUM_PERM3)
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, BIOMASS_C_MG_M3_SD = IND_C_MG_CONVERTED_SD*EST_NUM_PERM3)
#Create carbon weight biomass column converted individual carbon weight and abundance
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, PRODUCTION_MG_C_D_MEAN = (IND_C_MG_CONVERTED_MEAN*EST_NUM_PERM3*GROWTH_RATE_MEAN)*24)
NBS_Zoop_Process_Final <- mutate(NBS_Zoop_Process_Final, PRODUCTION_MG_C_D_SD = (IND_C_MG_CONVERTED_SD*EST_NUM_PERM3*GROWTH_RATE_SD)*24)
new_zoop <- read.csv("data/AllZoop_Raw_26JUL2024.csv") %>%
filter(YEAR> 2019,
!LAT<55.0473,
!LAT>66.1)
combo <- rbind(new_zoop %>%
dplyr::select(CRUISE, DAY, GEAR_NAME, HAUL_ID,LAT,LON,
STAGE_NAME,TAXON_NAME,TAXA_COARSE, YEAR,EST_NUM_PERM3),
NBS_Zoop_Process_Final %>%
dplyr::select(CRUISE, DAY, GEAR_NAME, HAUL_ID,LAT,LON,
STAGE_NAME,TAXON_NAME, TAXA_COARSE,YEAR,EST_NUM_PERM3))
combo <- rbind(new_zoop %>%
dplyr::select(CRUISE, DAY, GEAR_NAME, HAUL_ID,LAT,LON,
STAGE_NAME,TAXON_NAME, YEAR,EST_NUM_PERM3),
NBS_Zoop_Process_Final %>%
dplyr::select(CRUISE, DAY, GEAR_NAME, HAUL_ID,LAT,LON,
STAGE_NAME,TAXON_NAME,YEAR,EST_NUM_PERM3))
write.csv(combo, here("data", "Processed_Data", "NBS_Zoop_Process_Final.csv"), row.names = FALSE)
zoop <- DF %>%
group_by(DATA_SOURCE,CRUISE,HAUL_ID,YEAR,MONTH,DAY,LAT,LON, TAXON_NAME) %>% # sum across life stages
dplyr::summarise(EST_NUM_PERM3 =  sum(EST_NUM_PERM3)) %>%
filter(!LAT<58,
!LAT>65,
!LON> -155,
!LON< -172,
MONTH %in% c(7,8,9,10)) %>%
unite("date", c(YEAR, MONTH, DAY), sep = "/", remove = FALSE) %>%
dplyr::mutate(date = as.Date(date, "%Y/%m/%d"),
DOY = yday(date))
DF  <- read.csv(here("data", "Processed_Data", "NBS_Zoop_Process_Final.csv"))
zoop <- DF %>%
group_by(DATA_SOURCE,CRUISE,HAUL_ID,YEAR,MONTH,DAY,LAT,LON, TAXON_NAME) %>% # sum across life stages
dplyr::summarise(EST_NUM_PERM3 =  sum(EST_NUM_PERM3)) %>%
filter(!LAT<58,
!LAT>65,
!LON> -155,
!LON< -172,
MONTH %in% c(7,8,9,10)) %>%
unite("date", c(YEAR, MONTH, DAY), sep = "/", remove = FALSE) %>%
dplyr::mutate(date = as.Date(date, "%Y/%m/%d"),
DOY = yday(date))
